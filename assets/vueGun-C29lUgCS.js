import{a as W,c as lt,az as ht,g as pt,aA as dt,aB as yt,h as z,N as tt,aC as vt,P as wt,aD as bt}from"./index-CplbzeJY.js";const gt={dark:{type:Boolean,default:null}};function kt(R,v){return W(()=>R.dark===null?v.dark.isActive:R.dark)}const mt={xs:8,sm:10,md:14,lg:20,xl:24},Dt=lt({name:"QChip",props:{...gt,...ht,dense:Boolean,icon:String,iconRight:String,iconRemove:String,iconSelected:String,label:[String,Number],color:String,textColor:String,modelValue:{type:Boolean,default:!0},selected:{type:Boolean,default:null},square:Boolean,outline:Boolean,clickable:Boolean,removable:Boolean,removeAriaLabel:String,tabindex:[String,Number],disable:Boolean,ripple:{type:[Boolean,Object],default:!0}},emits:["update:modelValue","update:selected","remove","click"],setup(R,{slots:v,emit:j}){const{proxy:{$q:$}}=pt(),n=kt(R,$),f=dt(R,mt),s=W(()=>R.selected===!0||R.icon!==void 0),w=W(()=>R.selected===!0?R.iconSelected||$.iconSet.chip.selected:R.icon),c=W(()=>R.iconRemove||$.iconSet.chip.remove),u=W(()=>R.disable===!1&&(R.clickable===!0||R.selected!==null)),r=W(()=>{const d=R.outline===!0&&R.color||R.textColor;return"q-chip row inline no-wrap items-center"+(R.outline===!1&&R.color!==void 0?` bg-${R.color}`:"")+(d?` text-${d} q-chip--colored`:"")+(R.disable===!0?" disabled":"")+(R.dense===!0?" q-chip--dense":"")+(R.outline===!0?" q-chip--outline":"")+(R.selected===!0?" q-chip--selected":"")+(u.value===!0?" q-chip--clickable cursor-pointer non-selectable q-hoverable":"")+(R.square===!0?" q-chip--square":"")+(n.value===!0?" q-chip--dark q-dark":"")}),i=W(()=>{const d=R.disable===!0?{tabindex:-1,"aria-disabled":"true"}:{tabindex:R.tabindex||0},S={...d,role:"button","aria-hidden":"false","aria-label":R.removeAriaLabel||$.lang.label.remove};return{chip:d,remove:S}});function h(d){d.keyCode===13&&k(d)}function k(d){R.disable||(j("update:selected",!R.selected),j("click",d))}function t(d){(d.keyCode===void 0||d.keyCode===13)&&(wt(d),R.disable===!1&&(j("update:modelValue",!1),j("remove")))}function p(){const d=[];u.value===!0&&d.push(z("div",{class:"q-focus-helper"})),s.value===!0&&d.push(z(tt,{class:"q-chip__icon q-chip__icon--left",name:w.value}));const S=R.label!==void 0?[z("div",{class:"ellipsis"},[R.label])]:void 0;return d.push(z("div",{class:"q-chip__content col row no-wrap items-center q-anchor--skip"},vt(v.default,S))),R.iconRight&&d.push(z(tt,{class:"q-chip__icon q-chip__icon--right",name:R.iconRight})),R.removable===!0&&d.push(z(tt,{class:"q-chip__icon q-chip__icon--remove cursor-pointer",name:c.value,...i.value.remove,onClick:t,onKeyup:t})),d}return()=>{if(R.modelValue===!1)return;const d={class:r.value,style:f.value};return u.value===!0&&Object.assign(d,i.value.chip,{onClick:k,onKeyup:h}),yt("div",d,p(),"ripple",R.ripple!==!1&&R.disable!==!0,()=>[[bt,R.ripple]])}}});var V=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function at(R){return R&&R.__esModule&&Object.prototype.hasOwnProperty.call(R,"default")?R.default:R}function ft(R){throw new Error('Could not dynamically require "'+R+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var X={exports:{}};X.exports;var rt;function st(){return rt||(rt=1,function(R){(function(){function v($,n){return n?ft($):$.slice?v[f($)]:function(s,w){$(s={exports:{}}),v[f(w)]=s.exports};function f(s){return s.split("/").slice(-1).toString().replace(".js","")}}var j=R;v(function($){String.random=function(f,s){var w="";for(f=f||24,s=s||"0123456789ABCDEFGHIJKLMNOPQRSTUVWXZabcdefghijklmnopqrstuvwxyz";f-- >0;)w+=s.charAt(Math.floor(Math.random()*s.length));return w},String.match=function(f,s){var w,c;return typeof f!="string"?!1:(typeof s=="string"&&(s={"=":s}),s=s||{},w=s["="]||s["*"]||s[">"]||s["<"],f===w?!0:c!==s["="]?!1:(w=s["*"]||s[">"],f.slice(0,(w||"").length)===w?!0:c!==s["*"]?!1:c!==s[">"]&&c!==s["<"]?f>=s[">"]&&f<=s["<"]:c!==s[">"]&&f>=s[">"]||c!==s["<"]&&f<=s["<"]))},String.hash=function(f,s){if(typeof f=="string"){if(s=s||0,!f.length)return s;for(var w=0,c=f.length,u;w<c;++w)u=f.charCodeAt(w),s=(s<<5)-s+u,s|=0;return s}};var n=Object.prototype.hasOwnProperty;Object.plain=function(f){return f?f instanceof Object&&f.constructor===Object||Object.prototype.toString.call(f).match(/^\[object (\w+)\]$/)[1]==="Object":!1},Object.empty=function(f,s){for(var w in f)if(n.call(f,w)&&(!s||s.indexOf(w)==-1))return!1;return!0},Object.keys=Object.keys||function(f){var s=[];for(var w in f)n.call(f,w)&&s.push(w);return s},function(){var f,s=setTimeout,w=0,c=0,u=typeof setImmediate!=""+f&&setImmediate||function(i,h){return typeof MessageChannel==""+f?s:((i=new MessageChannel).port1.onmessage=function(k){k.data==""&&h()},function(k){h=k,i.port2.postMessage("")})}(),r=s.check=s.check||typeof performance!=""+f&&performance||{now:function(){return+new Date}};s.hold=s.hold||9,s.poll=s.poll||function(i){if(s.hold>=r.now()-w&&c++<3333){i();return}u(function(){w=r.now(),i()},c=0)}}(),function(){var f=setTimeout,s=f.turn=f.turn||function(h){w.push(h)==1&&c(i)},w=s.s=[],c=f.poll,u=0,r,i=function(){(r=w[u++])&&r(),(u==w.length||u==99)&&(w=s.s=w.slice(u),u=0),w.length&&c(i)}}(),function(){var f,s=setTimeout,w=s.turn;(s.each=s.each||function(c,u,r,i){i=i||9,function h(k,t,p){if(t=(k=(c||[]).splice(0,i)).length){for(var d=0;d<t&&f===(p=u(k[d]));d++);if(f===p){w(h);return}}r&&r(p)}()})()}()})(v,"./shim"),v(function($){$.exports=function n(r,s,w){if(!r)return{to:n};var c,u=typeof s=="function",r=(this.tag||(this.tag={}))[r]||u&&(this.tag[r]={tag:r,to:n._={next:function(h){var k;(k=this.to)&&k.next(h)}}});if(u){var i={off:n.off||(n.off=function(){if(this.next===n._.next)return!0;this===this.the.last&&(this.the.last=this.back),this.to.back=this.back,this.next=n._.next,this.back.to=this.to,this.the.last===this.the&&delete this.on.tag[this.the.tag]}),to:n._,next:s,the:r,on:this,as:w};return(i.back=r.last||r).to=i,r.last=i}return(r=r.to)&&c!==s&&r.next(s),r}})(v,"./onto"),v(function($){$.exports=function(n){return n===null||typeof n=="string"||typeof n=="boolean"||typeof n=="number"&&n!=1/0&&n!=-1/0&&n===n||!!n&&typeof n["#"]=="string"&&Object.keys(n).length===1&&n["#"]}})(v,"./valid"),v(function($){v("./shim");function n(){var r=+new Date;return c<r?(s=0,c=r+n.drift):c=r+(s+=1)/w+n.drift}n.drift=0;var f=-1/0,s=0,w=999,c=f,u;n.is=function(r,i,h){var k=i&&r&&r._&&r._[">"]||h;if(k)return typeof(k=k[i])=="number"?k:f},n.ify=function(r,i,h,k,t){(r=r||{})._=r._||{},t&&(r._["#"]=t);var p=r._[">"]||(r._[">"]={});return u!==i&&i!=="_"&&(typeof h=="number"&&(p[i]=h),u!==k&&(r[i]=k)),r},$.exports=n})(v,"./state"),v(function($){v("./shim");function n(f){var s={s:{}},w=s.s;f=f||{max:999,age:1e3*9},s.check=function(u){return w[u]?c(u):!1};var c=s.track=function(u){var r=w[u]||(w[u]={});return r.was=s.now=+new Date,s.to||(s.to=setTimeout(s.drop,f.age+9)),c.ed&&c.ed(u),r};return s.drop=function(u){s.to=null,s.now=+new Date;var r=Object.keys(w);console.STAT&&console.STAT(s.now,+new Date-s.now,"dup drop keys"),setTimeout.each(r,function(i){var h=w[i];h&&(u||f.age)>s.now-h.was||delete w[i]},0,99)},s}$.exports=n})(v,"./dup"),v(function($){v("./onto"),$.exports=function(s,w){if(this.on){var c=(this.opt||{}).lack||9e3;if(typeof s!="function"){if(!s)return;var r=s["#"]||s,u=(this.tag||"")[r];return u?(w&&(u=this.on(r,w),clearTimeout(u.err),u.err=setTimeout(function(){u.off()},c)),!0):void 0}var r=w&&w["#"]||n(9);if(!s)return r;var i=this.on(r,s,w);return i.err=i.err||setTimeout(function(){i.off(),i.next({err:"Error: No ACK yet.",lack:!0})},c),r}};var n=String.random||function(){return Math.random().toString(36).slice(2)}})(v,"./ask"),v(function($){function n(t){return t instanceof n?(this._={$:this}).$:this instanceof n?n.create(this._={$:this,opt:t}):new n(t)}n.is=function(t){return t instanceof n||t&&t._&&t===t._.$||!1},n.version=.202,n.chain=n.prototype,n.chain.toJSON=function(){},v("./shim"),n.valid=v("./valid"),n.state=v("./state"),n.on=v("./onto"),n.dup=v("./dup"),n.ask=v("./ask"),function(){n.create=function(o){o.root=o.root||o,o.graph=o.graph||{},o.on=o.on||n.on,o.ask=o.ask||n.ask,o.dup=o.dup||n.dup();var m=o.$.opt(o.opt);return o.once||(o.on("in",t,o),o.on("out",t,o),o.on("put",S,o),n.on("create",o),o.on("create",o)),o.once=1,m};function t(o){if(o){if(o.out===t){this.to.next(o);return}var m=this,A=m.as,E=A.at||A,O=E.$,D=E.dup,G,N=o.DBG;if((G=o["#"])||(G=o["#"]=s(9)),!D.check(G)){if(D.track(G),G=o._,o._=typeof G=="function"?G:function(){},o.$&&o.$===(o.$._||"").$||(o.$=O),o["@"]&&!o.put&&e(o),!E.ask(o["@"],o))if(N&&(N.u=+new Date),o.put){p(o);return}else o.get&&n.on.get(o,O);N&&(N.uc=+new Date),m.to.next(o),N&&(N.ua=+new Date),!(o.nts||o.NTS)&&(o.out=t,E.on("out",o),N&&(N.ue=+new Date))}}}function p(o){if(o){var m=o._||"",A=m.root=((m.$=o.$||"")._||"").root;if(o["@"]&&m.faith&&!m.miss){o.out=t,A.on("out",o);return}m.latch=A.hatch,m.match=A.hatch=[];var E=o.put,O=m.DBG=o.DBG,D=+new Date;if(C=C||D,!(E["#"]&&E["."])){O&&(O.p=D),m["#"]=o["#"],m.msg=o,m.all=0,m.stun=1;var G=Object.keys(E);console.STAT&&console.STAT(D,((O||m).pk=+new Date)-D,"put sort");var N=0,I,P,U,J,q,M,L;(function K(Y){if(I!=N){if(I=N,!(U=G[N])){console.STAT&&console.STAT(D,((O||m).pd=+new Date)-D,"put"),a(m);return}(J=E[U])?(L=J._)?U!==L["#"]?M=y+_(U)+"soul not same.":(q=L[">"])||(M=y+_(U)+"no state."):M=y+_(U)+"no meta.":M=y+_(U)+"no node.",P=Object.keys(J||{})}if(M){o.err=m.err=M,a(m);return}var et=0,H;for(Y=Y||0;Y++<9&&(H=P[et++]);)if(H!=="_"){var Q=J[H],nt=q[H];if(i===nt){M=y+_(H)+"on"+_(U)+"no state.";break}if(!c(Q)){M=y+_(H)+"on"+_(U)+"bad "+typeof Q+_(Q);break}d(Q,H,U,nt,o),++B}if((P=P.slice(et)).length){w(K);return}++N,P=null,K(Y)})()}}}n.on.put=p;function d(o,m,A,E,O){var D=O._||"",G=D.root,N=G.graph,I,P=N[A]||h,U=u(P,m,1),J=P[m],q=D.DBG;(I=console.STAT)&&(!N[A]||!J)&&(I.has=(I.has||0)+1);var M=T();if(E>M){setTimeout(function(){d(o,m,A,E,O)},(I=E-M)>x?x:I),console.STAT&&console.STAT((q||D).Hf=+new Date,I,"future");return}if(!(E<U)&&!(!D.faith&&E===U&&(o===J||g(o)<=g(J))&&!D.miss)){D.stun++;var L=O["#"]+D.all++,K={toString:function(){return L},_:D};K.toJSON=K.toString,G.dup.track(K)["#"]=O["#"],q&&(q.ph=q.ph||+new Date),G.on("put",{"#":K,"@":O["@"],put:{"#":A,".":m,":":o,">":E},ok:O.ok,_:D})}}function S(o){var m;(m=(o._||"").DBG)&&(m.pa=+new Date,m.pm=m.pm||+new Date);var A=this,E=A.as,O=E.graph,D=o._,G=o.put,N=G["#"],I=G["."],P=G[":"],U=G[">"];o["#"];var J;(J=D.msg)&&(J=J.put)&&(J=J[N])&&r(J,I,U,P,N),O[N]=r(O[N],I,U,P,N),(J=(E.next||"")[N])&&J.on("in",o),a(D),A.to.next(o)}function a(o,m){var A;if(!o.stop&&!(!o.err&&0<--o.stun)&&(o.stop=1,!!(A=o.root))){var E=o.match;E.end=1,E===A.hatch&&(!(E=o.latch)||E.end?delete A.hatch:A.hatch=E),o.hatch&&o.hatch(),setTimeout.each(o.match,function(O){O&&O()}),!(!(m=o.msg)||o.err||m.err)&&(m.out=t,o.root.on("out",m),b())}}function e(o){var m=o["@"]||"",A;if(!(A=m._)){var E=(E=o.$)&&(E=E._)&&(E=E.root)&&(E=E.dup);if(!(E=E.check(m)))return;o["@"]=E["#"]||o["@"];return}A.acks=(A.acks||0)+1,(A.err=o.err)&&(o["@"]=A["#"],a(A)),A.ok=o.ok||A.ok,!A.stop&&!A.crack&&(A.crack=A.match&&A.match.push(function(){l(A)})),l(A)}function l(o){!o||!o.root||o.stun||o.acks!==o.all||o.root.on("in",{"@":o["#"],err:o.err,ok:o.err?i:o.ok||{"":1}})}var y="Error: Invalid graph!",_=function(o){return" '"+(""+o).slice(0,9)+"...' "},g=JSON.stringify,x=2147483647,T=n.state,B=0,C,b=function(){B>999&&B/-(C-(C=+new Date))>1&&(n.window&&console.log("Warning: You're syncing 1K+ records a second, faster than DOM can update - consider limiting query."),b=function(){B=0})}}(),function(){n.on.get=function(p,d){var S=d._,a=p.get,e=a["#"],l=S.graph[e],y=a["."],_=S.next||(S.next={}),g=_[e],x=p._||{},T=x.DBG=p.DBG;if(T&&(T.g=+new Date),!l)return S.on("get",p);if(y){if((typeof y!="string"||i===l[y])&&!((g||"").next||"")[y]){S.on("get",p);return}l=r({},y,u(l,y),l[y],e)}l&&t(p,l),S.on("get",p)};function t(p,d){var S=+new Date,a=p._||{},e=a.DBG=p.DBG,l=p["#"],y=s(9),_=Object.keys(d||"").sort(),g=((d||"")._||"")["#"];_.length;var x=p.$._.root,T=d===x.graph[g];console.STAT&&console.STAT(S,((e||a).gk=+new Date)-S,"got keys"),d&&function B(){S=+new Date;for(var C=0,b,o={},m;C<9&&(b=_[C++]);)r(o,b,u(d,b),d[b],g);_=_.slice(C),(m={})[g]=o,o=m;var A;T&&(A=function(){},A.ram=A.faith=!0),m=_.length,console.STAT&&console.STAT(S,-(S-(S=+new Date)),"got copied some"),e&&(e.ga=+new Date),x.on("in",{"@":l,"#":y,put:o,"%":m?y=s(9):i,$:x.$,_:A,DBG:e,FOO:1}),console.STAT&&console.STAT(S,+new Date-S,"got in"),m&&setTimeout.turn(B)}(),d||x.on("in",{"@":p["#"]})}n.on.get.ack=t}(),function(){n.chain.opt=function(t){t=t||{};var p=this,d=p._,S=t.peers||t;return Object.plain(t)||(t={}),Object.plain(d.opt)||(d.opt=t),typeof S=="string"&&(S=[S]),Object.plain(d.opt.peers)||(d.opt.peers={}),S instanceof Array&&(t.peers={},S.forEach(function(a){var e={};e.id=e.url=a,t.peers[a]=d.opt.peers[a]=d.opt.peers[a]||e})),f(t,function a(e){var l=this[e];if(this&&this.hasOwnProperty(e)||typeof l=="string"||Object.empty(l)){this[e]=l;return}l&&l.constructor!==Object&&!(l instanceof Array)||f(l,a)}),d.opt.from=t,n.on("opt",d),d.opt.uuid=d.opt.uuid||function(e){return n.state().toString(36).replace(".","")+String.random(e||12)},p}}();var f=function(t,p){Object.keys(t).forEach(p,t)},s=String.random,w=setTimeout.turn,c=n.valid,u=n.state.is,r=n.state.ify,i,h={},k;n.log=function(){return!n.log.off&&k.log.apply(k,arguments),[].slice.call(arguments).join(" ")},n.log.once=function(t,p,d){return(d=n.log.once)[t]=d[t]||0,d[t]++||n.log(p)},typeof window<"u"&&((window.GUN=window.Gun=n).window=window);try{typeof j<"u"&&(j.exports=n)}catch{}$.exports=n,(n.window||{}).console=(n.window||{}).console||{log:function(){}},(k=console).only=function(t,p){return k.only.i&&t===k.only.i&&k.only.i++&&(k.log.apply(k,arguments)||p)},n.log.once("welcome","Hello wonderful person! :) Thanks for using GUN, please ask for help on http://chat.gun.eco if anything takes you longer than 5min to figure out!")})(v,"./root"),v(function($){var n=v("./root");n.chain.back=function(w,c){var u;if(w=w||1,w===-1||w===1/0)return this._.root.$;if(w===1)return(this._.back||this._).$;var r=this,i=r._;if(typeof w=="string"&&(w=w.split(".")),w instanceof Array){var h=0,k=w.length,u=i;for(h;h<k;h++)u=(u||f)[w[h]];return s!==u?c?r:u:(u=i.back)?u.$.back(w,c):void 0}if(typeof w=="function"){for(var t,u={back:i};(u=u.back)&&s===(t=w(u,c)););return t}return typeof w=="number"?(i.back||i).$.back(w-1):this};var f={},s})(v,"./back"),v(function($){var n=v("./root");n.chain.chain=function(a){var e=this,l=e._,y=new(a||e).constructor(e),_=y._,g;return _.root=g=l.root,_.id=++g.once,_.back=e._,_.on=n.on,_.on("in",n.on.in,_),_.on("out",n.on.out,_),y};function f(a){var e,l=this.as,y=l.back,_=l.root,g;if(a.$||(a.$=l.$),this.to.next(a),l.err){l.on("in",{put:l.put=i,$:l.$});return}if(e=a.get){if(_.pass&&(_.pass[l.id]=l),l.lex&&Object.keys(l.lex).forEach(function(x){g[x]=l.lex[x]},g=a.get=a.get||{}),e["#"]||l.soul){if(e["#"]=e["#"]||l.soul,a["#"]||(a["#"]=h(9)),y=_.$.get(e["#"])._,e=e["."]){if(t(y.put,e)&&(g=y.ask&&y.ask[e],(y.ask||(y.ask={}))[e]=y.$.get(e)._,y.on("in",{get:e,put:{"#":y.soul,".":e,":":y.put[e],">":d(_.graph[y.soul],e)}}),g))return}else{if(g=y.ask&&y.ask[""],(y.ask||(y.ask={}))[""]=y,i!==y.put&&(y.on("in",y),g))return;a.$=y.$}return _.ask(u,a),_.on("in",a)}if(e["."])return l.get?(a={get:{".":l.get},$:l.$},(y.ask||(y.ask={}))[l.get]=a.$._,y.on("out",a)):(a={get:l.lex?a.get:{},$:l.$},y.on("out",a));if((l.ask||(l.ask={}))[""]=l,l.get)return e["."]=l.get,(y.ask||(y.ask={}))[l.get]=a.$._,y.on("out",a)}return y.on("out",a)}n.on.out=f;function s(a,e){e=e||this.as;var l=e.root,y=a.$||(a.$=e.$),_=(y||"")._||r,g=a.put||"",x=g["#"],T=g["."],B=i!==g["="]?g["="]:g[":"],C=g[">"]||-1/0,b;if(i!==a.put&&(i===g["#"]||i===g["."]||i===g[":"]&&i===g["="]||i===g[">"])){if(!k(g)){if(!(x=((g||"")._||"")["#"])){console.log("chain not yet supported for",g,"...",a,e);return}return y=e.root.$.get(x),setTimeout.each(Object.keys(g).sort(),function(o){o=="_"||i===(C=d(g,o))||e.on("in",{$:y,put:{"#":x,".":o,"=":g[o],">":C},VIA:a})})}e.on("in",{$:_.back.$,put:{"#":x=_.back.soul,".":T=_.has||_.get,"=":g,">":d(_.back.put,T)},via:a});return}(a.seen||"")[e.id]||((a.seen||(a.seen=function(){}))[e.id]=e,e!==_&&(Object.keys(a).forEach(function(o){g[o]=a[o]},g={}),g.get=e.get||g.get,!e.soul&&!e.has?g.$$$=g.$$$||e.$:_.soul&&(g.$=e.$,g.$$=g.$$||_.$),a=g),c(a,e),(e.soul||a.$$)&&C>=d(l.graph[x],T)&&((g=l.$.get(x)._).put=S(g.put,T,C,B,x)),!_.soul&&C>=d(l.graph[x],T)&&(b=(l.$.get(x)._.next||"")[T])&&(b.put=B,typeof(g=k(B))=="string"&&(b.put=l.$.get(g)._.put||B)),this.to&&this.to.next(a),e.any&&setTimeout.each(Object.keys(e.any),function(o){(o=e.any[o])&&o(a)},0,99),e.echo&&setTimeout.each(Object.keys(e.echo),function(o){(o=e.echo[o])&&o.on("in",a)},0,99),((a.$$||"")._||_).soul&&(b=e.next)&&(b=b[T])&&(g={},Object.keys(a).forEach(function(o){g[o]=a[o]}),g.$=(a.$$||a.$).get(g.get=T),delete g.$$,delete g.$$$,b.on("in",g)),w(a,e))}n.on.in=s;function w(a,e){if(e=e||this.as||a.$._,!(a.$$&&this!==n.on)&&!(!a.put||e.soul)){var l=a.put||"",y=l["="]||l[":"],T,_=e.root,g=_.$.get(l["#"]).get(l["."])._;if(typeof(y=k(y))!="string"){this===n.on&&((g.echo||(g.echo={}))[e.id]=e);return}if(!((g.echo||(g.echo={}))[e.id]&&!(_.pass||"")[e.id])){if(T=_.pass){if(T[y+e.id])return;T[y+e.id]=1}(g.echo||(g.echo={}))[e.id]=e,e.has&&(e.link=y);var x=_.$.get(g.link=y)._;(x.echo||(x.echo={}))[g.id]=g;var T=e.ask||"";(T[""]||e.lex)&&x.on("out",{get:{"#":y}}),setTimeout.each(Object.keys(T),function(B,C){!B||!(C=T[B])||C.on("out",{get:{"#":y,".":B}})},0,99)}}}n.on.link=w;function c(a,e){var l=a.put||"",y=i!==l["="]?l["="]:l[":"],_=e.root,g,x;if(i===y){if(e.soul&&i!==e.put||(x=(a.$$||a.$||"")._||"",a["@"]&&(i!==x.put||i!==e.put)))return;(g=e.link||a.linked)&&delete(_.$.get(g)._.echo||"")[e.id],e.has&&(e.link=null),e.put=i,setTimeout.each(Object.keys(e.next||""),function(T,B){(B=e.next[T])&&(g&&delete(_.$.get(g).get(T)._.echo||"")[B.id],B.on("in",{get:T,put:i,$:B.$}))},0,99);return}e.soul||a.$$||(g=k(y),x=a.$._||"",!((g===x.link||e.has&&!x.link)&&!((_.pass||"")[e.id]&&typeof g!="string"))&&(delete(x.echo||"")[e.id],c({get:e.get,put:i,$:a.$,linked:a.linked=a.linked||x.link},e)))}n.on.unlink=c;function u(a,e){var l=this.as,y=l.$._;y.root;var _=l.get||"",g=(a.put||"")[_["#"]]||"";if(!a.put||typeof _["."]=="string"&&i===g[_["."]]){if(i!==y.put||!y.soul&&!y.has)return;y.ack=(y.ack||0)+1,y.on("in",{get:y.get,put:y.put=i,$:y.$,"@":a["@"]});return}(a._||{}).miss=1,n.on.put(a)}var r={},i,h=String.random,k=n.valid,t=function(a,e){return a&&Object.prototype.hasOwnProperty.call(a,e)},p=n.state,d=p.is,S=p.ify})(v,"./chain"),v(function($){var n=v("./root");n.chain.get=function(i,h,k){var t,p;if(typeof i=="string"){if(i.length==0)return(t=this.chain())._.err={err:n.log("0 length key!",i)},h&&h.call(t,t._.err),t;var d=this,S=d._,a=S.next||c;(t=a[i])||(t=i&&f(i,d)),t=t&&t.$}else if(typeof i=="function"){let x=function(T,B,C){if(!x.stun&&!((O=l.pass)&&!O[y])){var b=T.$._,o=(T.$$||"")._,m=(o||b).put,A=!b.has&&!b.soul,E={},O;if((A||r===m)&&(m=r===((O=T.put)||"")["="]?r===(O||"")[":"]?O:O[":"]:O["="]),typeof(O=n.valid(m))=="string"&&(m=r===(O=l.$.get(O)._.put)?e.not?r:m:O),!(e.not&&r===m)){if(r===e.stun){if((O=l.stun)&&O.on&&(S.$.back(function(D){if(O.on(""+D.id,E={}),(E.run||0)<x.id)return E}),!E.run&&O.on(""+b.id,E={}),!E.run&&o&&O.on(""+o.id,E={}),x.id>E.run&&((!E.stun||E.stun.end)&&(E.stun=O.on("stun"),E.stun=E.stun&&E.stun.last),E.stun&&!E.stun.end))){(E.stun.add||(E.stun.add={}))[y]=function(){x(T,B,1)};return}if(r===m&&(C=0),(O=l.hatch)&&!O.end&&r===e.hatch&&!C){if(_[b.$._.id])return;_[b.$._.id]=1,O.push(function(){x(T,B,1)});return}_={}}if(l.pass){if(l.pass[y+b.id])return;l.pass[y+b.id]=1}if(e.on){e.ok.call(b.$,m,b.get,T,B||x);return}if(e.v2020){e.ok(T,B||x);return}Object.keys(T).forEach(function(D){O[D]=T[D]},O={}),T=O,T.put=m,e.ok.call(e.as,T,B||x)}}};if(h===!0)return s(this,i,h,k),this;t=this;var S=t._,e=h||{},l=S.root,y;e.at=S,e.ok=i;var _={};return x.at=S,(S.any||(S.any={}))[y=String.random(7)]=x,x.off=function(){x.stun=1,S.any&&delete S.any[y]},x.rid=w,x.id=e.run||++l.once,p=l.pass,(l.pass={})[y]=1,e.out=e.out||{get:{}},S.on("out",e.out),l.pass=p,t}else{if(typeof i=="number")return this.get(""+i,h,k);if(typeof(p=u(i))=="string")return this.get(p,h,k);(p=this.get.next)&&(t=p(this,i))}return t?(h&&typeof h=="function"&&t.get(h,k),t):((t=this.chain())._.err={err:n.log("Invalid get request!",i)},h&&h.call(t,t._.err),t)};function f(i,h){var k=h._,t=k.next,p=h.chain(),d=p._;return t||(t=k.next={}),t[d.get=i]=d,h===k.root.$?d.soul=i:(k.soul||k.has)&&(d.has=i),d}function s(i,h,k,t){var p=i._,d=0,S;return(S=p.soul||p.link)?h(S,t,p):p.jam?p.jam.push([h,t]):(p.jam=[[h,t]],i.get(function(e,l){if(!(r===e.put&&!p.root.opt.super&&(S=Object.keys(p.root.opt.peers).length)&&++d<=S)){l.rid(e);var y=(y=e.$)&&y._||{},_=0,g;for(S=p.jam,delete p.jam;g=S[_++];){var x=g[0];g=g[1],x&&x(y.link||y.soul||n.valid(e.put)||((e.put||{})._||{})["#"],g,e,l)}}},{out:{get:{".":!0}}}),i)}function w(i){var h=this.at||this.on;if(!i||h.soul||h.has)return this.off();if(i=(i=(i=i.$||i)._||i).id){h.map;var k;if((k=this.seen||(this.seen={}))[i])return!0;k[i]=!0}}var c={},u=n.valid,r})(v,"./get"),v(function($){var n=v("./root");n.chain.put=function(t,p,d){var S=this,a=S._,e=a.root;d=d||{},d.root=a.root,d.run||(d.run=e.once),f(d,a.id),d.ack=d.ack||p,d.via=d.via||S,d.data=d.data||t,d.soul||(d.soul=a.soul||typeof p=="string"&&p);var l=d.state=d.state||n.state();return typeof t=="function"?(t(function(y){d.data=y,S.put(u,u,d)}),S):d.soul?(d.$=e.$.get(d.soul),d.todo=[{it:d.data,ref:d.$}],d.turn=d.turn||i,d.ran=d.ran||s,function y(){var _=d.todo,g=_.pop(),x=g.it;g.ref&&g.ref._.id;var T,B,C,b,o;if(f(d,g.ref),(b=g.todo)&&(B=b.pop(),x=x[B],b.length&&_.push(g)),B&&(_.path||(_.path=[])).push(B),!(T=h(x))&&!(o=n.is(x))){if(!Object.plain(x)){s.err(d,"Invalid data: "+c(x)+" at "+(d.via.back(function(O){O.get&&b.push(O.get)},b=[])||b.join("."))+"."+(_.path||[]).join("."));return}for(var m=d.seen||(d.seen=[]),A=m.length;A--;)if(x===(b=m[A]).it){T=x=b.link;break}}if(B&&T)g.node=k(g.node,B,l,x);else{let O=function(D,G){var N=C.link["#"];G&&(G.off(),G.rid(D));var I=N||D.soul||(b=(D.$$||D.$)._||"").soul||b.link||((b=b.put||"")._||"")["#"]||b["#"]||((b=D.put||"")&&D.$$?b["#"]:(b["="]||b[":"]||"")["#"]);if(!N&&f(d,D.$),!I&&!g.link["#"]){(g.wait||(g.wait=[])).push(function(){O(D,G)});return}I||(I=[],(D.$$||D.$).back(function(P){if(b=P.soul||P.link)return I.push(b);I.push(P.get)}),I=I.reverse().join("/")),C.link["#"]=I,!o&&(((d.graph||(d.graph={}))[I]=C.node||(C.node={_:{}}))._["#"]=I),delete d.wait[E],C.wait&&setTimeout.each(C.wait,function(P){P&&P()}),d.ran(d)};if(!d.seen){s.err(d,"Data at root of graph must be a node (an object).");return}d.seen.push(C={it:x,link:{},todo:o?[]:Object.keys(x).sort().reverse(),path:(_.path||[]).slice(),up:g}),g.node=k(g.node,B,l,C.link),!o&&C.todo.length&&_.push(C);var E=d.seen.length;(d.wait||(d.wait={}))[E]="",b=(C.ref=o?x:B?g.ref.get(B):g.ref)._,(b=x&&(x._||"")["#"]||b.soul||b.link)?O({soul:b}):C.ref.get(O,{run:d.run,v2020:1,out:{get:{".":" "}}})}if(!_.length)return d.ran(d);d.turn(y)}(),S):(w(d),S)};function f(t,p){if(p){p=(p._||"").id||p;var d=t.root.stun||(t.root.stun={on:n.on}),S={},a;t.stun||(t.stun=d.on("stun",function(){})),(a=d.on(""+p))&&a.the.last.next(S),!(S.run>=t.run)&&d.on(""+p,function(e){if(t.stun.end){this.off(),this.to.next(e);return}e.run=e.run||t.run,e.stun=e.stun||t.stun})}}function s(t){if(t.err){s.end(t.stun,t.root);return}if(!(t.todo.length||t.end||!Object.empty(t.wait))){t.end=1;var p=t.$.back(-1)._,d=p.root,S=p.ask(function(y){d.on("ack",y),y.err&&!y.lack&&n.log(y),++a>(t.acks||0)&&this.off(),t.ack&&t.ack(y,this)},t.opt),a=0,e=t.stun,l;(l=function(){e&&(s.end(e,d),setTimeout.each(Object.keys(e=e.add||""),function(y){(y=e[y])&&y()}))}).hatch=l,t.ack&&!t.ok&&(t.ok=t.acks||9),t.via._.on("out",{put:t.out=t.graph,ok:t.ok&&{"@":t.ok+1},opt:t.opt,"#":S,_:l})}}s.end=function(t,p){t.end=r,t.the.to===t&&t===t.the.last&&delete p.stun,t.off()},s.err=function(t,p){(t.ack||r).call(t,t.out={err:t.err=n.log(p)}),t.ran(t)};function w(t){var p=t.via._,d;t.via=t.via.back(function(S){if(S.soul||!S.get)return S.$;d=t.data,(t.data={})[S.get]=d}),(!t.via||!t.via._.soul)&&(t.via=p.root.$.get(((t.data||"")._||"")["#"]||p.$.back("opt.uuid")())),t.via.put(t.data,t.ack,t)}function c(t,p){return t&&(p=t.constructor)&&p.name||typeof t}var u,r=function(){},i=setTimeout.turn,h=n.valid,k=n.state.ify})(v,"./put"),v(function($){var n=v("./root");v("./chain"),v("./back"),v("./put"),v("./get"),$.exports=n})(v,"./index"),v(function($){var n=v("./index");n.chain.on=function(w,c,u,r){var i=this,h=i._;h.root;var k;if(typeof w=="string")return c?(k=h.on(w,c,u||h,r),u&&u.$&&(u.subs||(u.subs=[])).push(k),i):h.on(w);var t=c;return(t=t===!0?{change:!0}:t||{}).not=1,t.on=1,i.get(w,t),i},n.chain.once=function(w,c){if(c=c||{},!w)return f(this);var u=this,r=u._,i=r.root;r.put;var h=String.random(7),k;return u.get(function(t,p,d,S){var a=this,e=a._,l=e.one||(e.one={});if(S.stun||l[h]==="")return;if((k=n.valid(t))===!0){y();return}if(typeof k=="string")return;clearTimeout((r.one||"")[h]),clearTimeout(l[h]),l[h]=setTimeout(y,c.wait||99);function y(_){if(!e.has&&!e.soul&&(e={put:t,get:p}),s===(k=e.put)&&(k=((d.$$||"")._||"").put),typeof n.valid(k)=="string"&&(k=i.$.get(k)._.put,k===s&&!_)){l[h]=setTimeout(function(){y(1)},c.wait||99);return}S.stun||l[h]!==""&&(l[h]="",(r.soul||r.has)&&S.off(),w.call(a,k,e.get),clearTimeout(l[h]))}},{on:1}),u};function f(w,c,u){return n.log.once("valonce","Chainable val is experimental, its behavior and API may change moving forward. Please play with it and report bugs and ideas on how to improve it."),(u=w.chain())._.nix=w.once(function(r,i){u._.on("in",this._)}),u._.lex=w._.lex,u}n.chain.off=function(){var w=this,c=w._,u,r=c.back;if(r)return c.ack=0,(u=r.next)&&u[c.get]&&delete u[c.get],(u=r.any)&&(delete r.any,r.any={}),(u=r.ask)&&delete u[c.get],(u=r.put)&&delete u[c.get],(u=c.soul)&&delete r.root.graph[u],(u=c.map)&&Object.keys(u).forEach(function(i,h){h=u[i],h.link&&r.root.$.get(h.link).off()}),(u=c.next)&&Object.keys(u).forEach(function(i,h){h=u[i],h.$.off()}),c.on("off",{}),w};var s})(v,"./on"),v(function($){var n=v("./index"),f=n.chain.get.next;n.chain.get.next=function(u,r){var i;return Object.plain(r)?(i=((i=r["#"])||"")["="]||i)?u.get(i):((i=u.chain()._).lex=r,u.on("in",function(h){String.match(h.get||(h.put||"")["."],r["."]||r["#"]||r)&&i.on("in",h),this.to.next(h)}),i.$):(f||w)(u,r)},n.chain.map=function(u,r,i){var h=this,k=h._,t,p;return Object.plain(u)&&(t=u["."]?u:{".":u},u=c),u?(n.log.once("mapfn","Map functions are experimental, their behavior and API may change moving forward. Please play with it and report bugs and ideas on how to improve it."),p=h.chain(),h.map().on(function(d,S,a,e){var l=(u||w).call(this,d,S,a,e);if(c!==l){if(d===l)return p._.on("in",a);if(n.is(l))return p._.on("in",l._);var y={};Object.keys(a.put).forEach(function(_){y[_]=a.put[_]},y),y["="]=l,p._.on("in",{get:S,put:y})}}),p):((p=k.each)||((k.each=p=h.chain())._.lex=t||p._.lex||k.lex,p._.nix=h.back("nix"),h.on("in",s,p._)),p)};function s(u){this.to.next(u);var r=this.as,i=u.$,h=i._,k=u.put,t;!h.soul&&!u.$$||(t=r.lex)&&!String.match(u.get||(k||"")["."],t["."]||t["#"]||t)||n.on.link(u,r)}var w=function(){},c})(v,"./map"),v(function($){var n=v("./index");n.chain.set=function(f,s,w){var c=this,u=c.back(-1),r,i;return s=s||function(){},w=w||{},w.item=w.item||f,(r=((f||"")._||"")["#"])&&((f={})["#"]=r),typeof(i=n.valid(f))=="string"?c.get(r=i).put(f,s,w):n.is(f)?(c.put(function(h){f.get(function(k,t,p){if(!k)return s.call(c,{err:n.log('Only a node can be linked! Not "'+p.put+'"!')});(i={})[k]={"#":k},h(i)},!0)}),f):(Object.plain(f)&&(f=u.get(r=c.back("opt.uuid")()).put(f)),c.get(r||u.back("opt.uuid")(7)).put(f,s,w))}})(v,"./set"),v(function($){v("./shim");var n=function(){},f=JSON.parseAsync||function(u,r,i){var h,k=+new Date;try{r(h,JSON.parse(u,i),s.sucks(+new Date-k))}catch(t){r(t)}},s=JSON.stringifyAsync||function(u,r,i,h){var k,t=+new Date;try{r(k,JSON.stringify(u,i,h),s.sucks(+new Date-t))}catch(p){r(p)}};s.sucks=function(u){u>99&&(console.log("Warning: JSON blocking CPU detected. Add `gun/lib/yson.js` to fix."),s.sucks=n)};function w(u){var r=function(){},i=u.opt||{};i.log=i.log||console.log,i.gap=i.gap||i.wait||0,i.max=i.max||(i.memory?i.memory*999*999:3e8)*.3,i.pack=i.pack||i.max*.01*.01,i.puff=i.puff||9;var h=setTimeout.turn||setTimeout,k=u.dup,t=k.check,p=k.track,d=r.hear=function(e,l){if(e){if(i.max<=e.length)return r.say({dam:"!",err:"Message too big!"},l);r===this&&(d.d+=e.length||0,++d.c);var y=l.SH=+new Date,_=e[0],g;if(_==="["){f(e,function(x,T){if(x||!T)return r.say({dam:"!",err:"DAM JSON parse error."},l);console.STAT&&console.STAT(+new Date,T.length,"# on hear batch");var B=i.puff;(function C(){for(var b=+new Date,o=0,m;o<B&&(m=T[o++]);)r.hear(m,l);T=T.slice(o),console.STAT&&console.STAT(b,+new Date-b,"hear loop"),S(l),T.length&&h(C,0)})()}),e="";return}if(_==="{"||(e["#"]||Object.plain(e))&&(g=e)){if(g)return d.one(g,l,y);f(e,function(x,T){if(x||!T)return r.say({dam:"!",err:"DAM JSON parse error."},l);d.one(T,l,y)});return}}};d.one=function(e,l,C){var _,g,x,T,B;if(e.DBG&&(e.DBG=B={DBG:e.DBG}),B&&(B.h=C),B&&(B.hp=+new Date),(_=e["#"])||(_=e["#"]=String.random(9)),!(x=t(_))&&(g=e["##"],!(g&&(x=e["@"]||e.get&&_)&&k.check(T=x+g)))){if((e._=function(){}).via=r.leap=l,(x=e["><"])&&typeof x=="string"&&x.slice(0,99).split(",").forEach(function(b){this[b]=1},e._.yo={}),x=e.dam){(x=r.hear[x])&&x(e,l,u),p(_);return}(x=e.ok)&&(e._.near=x["/"]);var C=+new Date;B&&(B.is=C),l.SI=_,p.ed=function(b){_===b&&(p.ed=0,(b=k.s[_])&&(b.via=l,e.get&&(b.it=e)))},u.on("in",r.last=e),B&&(B.hd=+new Date),console.STAT&&console.STAT(C,+new Date-C,e.get?"msg get":e.put?"msg put":"msg"),p(_),T&&p(T),r.leap=r.last=null}},d.c=d.d=0,function(){var e=0,l;r.hash=function(g,x){var T,B,C,b=+new Date;s(g.put,function o(m,A){var E=(B||(B=C=A||"")).slice(0,32768);if(T=String.hash(E,T),B=B.slice(32768),B){h(o,0);return}console.STAT&&console.STAT(b,+new Date-b,"say json+hash"),g._.$put=C,g["##"]=T,r.say(g,x),delete g._.$put},y)};function y(g,x){var T;return x instanceof Object?(Object.keys(x).sort().forEach(_,{to:T={},on:x}),T):x}function _(g){this.to[g]=this.on[g]}r.say=function(g,x){var T;if((T=this)&&(T=T.to)&&T.next&&T.next(g),!g)return!1;var B,C,b,o=g["@"],m=g._||(g._=function(){}),A=g.DBG,E=+new Date;if(m.y=m.y||E,x||A&&(A.y=E),(B=g["#"])||(B=g["#"]=String.random(9)),!l&&p(B),!(C=g["##"])&&c!==g.put&&!m.via&&o){r.hash(g,x);return}if(!x&&o&&(x=(T=k.s[o])&&(T.via||(T=T.it)&&(T=T._)&&T.via)||(T=r.last)&&o===T["#"]&&r.leap),!x&&o)return k.s[o]?void 0:(console.STAT&&console.STAT(+new Date,++e,"total no peer to ack to"),!1);if(o&&!g.put&&!C&&((k.s[o]||"").it||"")["##"])return!1;if(!x&&r.way)return r.way(g);if(A&&(A.yh=+new Date),!(b=m.raw)){r.raw(g,x);return}if(A&&(A.yr=+new Date),!x||!x.id){if(!Object.plain(x||i.peers))return!1;var E=+new Date;i.puff;var O=i.peers,D=Object.keys(x||i.peers||{});console.STAT&&console.STAT(E,+new Date-E,"peer keys"),function I(){var P=+new Date;l=1;var U=m.raw;m.raw=b;for(var J=0,q;J<9&&(q=(D||"")[J++]);)(q=O[q]||(x||"")[q])&&r.say(g,q);m.raw=U,l=0,D=D.slice(J),console.STAT&&console.STAT(P,+new Date-P,"say loop"),D.length&&(h(I,0),o&&p(o))}();return}if(!x.wire&&r.wire&&r.wire(x),B!==x.last){if(x.last=B,x===m.via||(T=m.yo)&&(T[x.url]||T[x.pid]||T[x.id]))return!1;if(console.STAT&&console.STAT(E,((A||m).yp=+new Date)-(m.y||E),"say prep"),!l&&o&&p(o),x.batch){if(x.tail=(T=x.tail||0)+b.length,x.tail<=i.pack){x.batch+=(T?",":"")+b;return}S(x)}x.batch="[";var G=+new Date;setTimeout(function(){console.STAT&&console.STAT(G,+new Date-G,"0ms TO"),S(x)},i.gap),a(b,x),console.STAT&&o===x.SI&&console.STAT(E,+new Date-x.SH,"say ack")}},r.say.c=r.say.d=0,r.raw=function(g,x){if(!g)return"";var T=g._||{},B,C;if(C=T.raw)return C;if(typeof g=="string")return g;var b=g["##"],o=g["@"];if(b&&o){if(!T.via&&t(o+b))return!1;if(C=(k.s[o]||"").it){if(b===C["##"])return!1;C["##"]||(C["##"]=b)}}if(!g.dam&&!g["@"]){var m=0,A=[];C=i.peers;for(var E in C){var O=C[E];if(A.push(O.url||O.pid||O.id),++m>6)break}m>1&&(g["><"]=A.join())}if(g.put&&(C=g.ok)&&(g.ok={"@":(C["@"]||1)-1,"/":C["/"]==g._.near?r.near:C["/"]}),B=T.$put){C={},Object.keys(g).forEach(function(G){C[G]=g[G]}),C.put=":])([:",s(C,function(G,N){if(!G){var I=+new Date;C=N.indexOf('"put":":])([:"'),D(c,N=N.slice(0,C+6)+B+N.slice(C+14)),console.STAT&&console.STAT(I,+new Date-I,"say slice")}});return}s(g,D);function D(G,N){G||(T.raw=N,r.say(g,x))}}}();function S(e){var l=e.batch,y=typeof l=="string";if(y&&(l+="]"),e.batch=e.tail=null,!!l&&!(y?3>l.length:!l.length)){if(!y)try{l=l.length===1?l[0]:JSON.stringify(l)}catch(_){return i.log("DAM JSON stringify error",_)}l&&a(l,e)}}function a(e,l){try{var y=l.wire;l.say?l.say(e):y.send&&y.send(e),r.say.d+=e.length||0,++r.say.c}catch{(l.queue=l.queue||[]).push(e)}}return r.near=0,r.hi=function(e){var l=e.wire,y;if(!l){r.wire(e.length&&{url:e,id:e}||e);return}e.id?i.peers[e.url||e.id]=e:(y=e.id=e.id||e.url||String.random(9),r.say({dam:"?",pid:u.opt.pid},i.peers[y]=e),delete k.s[e.last]),e.met||(r.near++,e.met=+new Date,u.on("hi",e)),y=e.queue,e.queue=[],setTimeout.each(y||[],function(_){a(_,e)},0,9)},r.bye=function(e){e.met&&--r.near,delete e.met,u.on("bye",e);var l=+new Date;l=l-(e.met||l),r.bye.time=((r.bye.time||l)+l)/2},r.hear["!"]=function(e,l){i.log("Error:",e.err)},r.hear["?"]=function(e,l){e.pid&&(l.pid||(l.pid=e.pid),e["@"])||(r.say({dam:"?",pid:i.pid,"@":e["#"]},l),delete k.s[l.last])},r.hear.mob=function(e,l){if(e.peers){var y=Object.keys(e.peers),_=y[Math.random()*y.length>>0];_&&(r.bye(l),r.hi(_))}},u.on("create",function(e){e.opt.pid=e.opt.pid||String.random(9),this.to.next(e),e.on("out",r.say)}),u.on("bye",function(e,l){e=i.peers[e.id||e]||e,this.to.next(e),e.bye?e.bye():(l=e.wire)&&l.close&&l.close(),delete i.peers[e.id],e.wire=null}),u.on("bye",function(e,l){this.to.next(e),(l=console.STAT)&&(l.peers=r.near),(l=e.url)&&setTimeout(function(){},i.lack||9e3)}),u.on("hi",function(e,l){if(this.to.next(e),(l=console.STAT)&&(l.peers=r.near),!i.super){var y=Object.keys(u.next||"");y.length>9999&&!console.SUBS&&console.log(console.SUBS="Warning: You have more than 10K live GETs, which might use more bandwidth than your screen can show - consider `.off()`."),setTimeout.each(y,function(_){var g=u.next[_];if(i.super||(g.ask||"")[""]){r.say({get:{"#":_}},e);return}setTimeout.each(Object.keys(g.ask||""),function(x){x&&r.say({"##":String.hash((u.graph[_]||"")[x]),get:{"#":_,".":x}},e)})})}}),r}var c;try{$.exports=w}catch{}})(v,"./mesh"),v(function($){var n=v("./index");n.Mesh=v("./mesh"),n.on("opt",function(s){if(this.to.next(s),s.once)return;var w=s.opt;if(w.WebSocket===!1)return;var c=n.window||{},u=w.WebSocket||c.WebSocket||c.webkitWebSocket||c.mozWebSocket;if(!u)return;w.WebSocket=u;var r=w.mesh=w.mesh||n.Mesh(s);r.wire||w.wire,r.wire=w.wire=i;function i(p){try{if(!p||!p.url)return S&&S(p);var d=p.url.replace(/^http/,"ws"),S=p.wire=new w.WebSocket(d);return S.onclose=function(){k(p),w.mesh.bye(p)},S.onerror=function(a){k(p)},S.onopen=function(){w.mesh.hi(p)},S.onmessage=function(a){a&&w.mesh.hear(a.data||a,p)},S}catch{w.mesh.bye(p)}}setTimeout(function(){!w.super&&s.on("out",{dam:"hi"})},1);var h=2*999;function k(p){clearTimeout(p.defer),w.peers[p.url]&&(t&&p.retry<=0||(p.retry=(p.retry||w.retry+1||60)-(-p.tried+(p.tried=+new Date)<h*4?1:0),p.defer=setTimeout(function d(){if(t&&t.hidden)return setTimeout(d,h);i(p)},h)))}var t=""+f!=typeof document&&document});var f})(v,"./websocket"),v(function($){if(!(typeof Gun>"u")){var n=function(){},f;try{f=(Gun.window||n).localStorage}catch{}f||(Gun.log("Warning: No localStorage exists to persist data to!"),f={setItem:function(w,c){this[w]=c},removeItem:function(w){delete this[w]},getItem:function(w){return this[w]}});var s=JSON.stringifyAsync||function(w,c,u,r){var i;try{c(i,JSON.stringify(w,u,r))}catch(h){c(h)}};Gun.on("create",function w(c){this.to.next(c);var u=c.opt;c.graph;var r=[],i,h,k,t;if(u.localStorage===!1)return;u.prefix=u.file||"gun/";try{i=w[u.prefix]=w[u.prefix]||JSON.parse(k=f.getItem(u.prefix))||{}}catch{i=w[u.prefix]={}}k=(k||"").length,c.on("get",function(d){this.to.next(d);var S=d.get,a,e,l,y;!S||!(a=S["#"])||(e=i[a]||y,e&&(l=S["."])&&!Object.plain(l)&&(e=Gun.state.ify({},l,Gun.state.is(e,l),e[l],a)),Gun.on.get.ack(d,e))}),c.on("put",function(d){this.to.next(d);var S=d.put,a=S["#"],e=S["."],l=d["#"],y=d.ok||"";if((c.next||"")[a]){if(i[a]=Gun.state.ify(i[a],e,S[">"],S[":"],a),t&&k>4999880){c.on("in",{"@":l,err:"localStorage max!"});return}!d["@"]&&(!d._.via||Math.random()<y["@"]/y["/"])&&r.push(l),!h&&(h=setTimeout(p,9+k/333))}});function p(){if(!r.length&&((setTimeout.turn||"").s||"").length){setTimeout(p,99);return}var d=r;clearTimeout(h),h=!1,r=[],s(i,function(S,a){try{!S&&f.setItem(u.prefix,a)}catch(e){S=t=e||"localStorage failure"}S&&(Gun.log(S+" Consider using GUN's IndexedDB plugin for RAD for more storage space, https://gun.eco/docs/RAD#install"),c.on("localStorage:error",{err:S,get:u.prefix,put:i})),k=a.length,setTimeout.each(d,function(e){c.on("in",{"@":e,err:S,ok:0})},0,99)})}})}})(v,"./localStorage")})(),function(){var C;if(""+C!=typeof Gun){var v=function(b){console.warn("Warning! Deprecated internal utility will break in next version:",b)},j=Gun;j.fn=j.fn||{is:function(b){return v("fn"),!!b&&typeof b=="function"}},j.bi=j.bi||{is:function(b){return v("bi"),b instanceof Boolean||typeof b=="boolean"}},j.num=j.num||{is:function(b){return v("num"),!$(b)&&(b-parseFloat(b)+1>=0||b===1/0||b===-1/0)}},j.text=j.text||{is:function(b){return v("text"),typeof b=="string"}},j.text.ify=j.text.ify||function(b){return v("text.ify"),j.text.is(b)?b:typeof JSON<"u"?JSON.stringify(b):b&&b.toString?b.toString():b},j.text.random=j.text.random||function(b,o){v("text.random");var m="";for(b=b||24,o=o||"0123456789ABCDEFGHIJKLMNOPQRSTUVWXZabcdefghijklmnopqrstuvwxyz";b>0;)m+=o.charAt(Math.floor(Math.random()*o.length)),b--;return m},j.text.match=j.text.match||function(b,o){var m,A;return v("text.match"),typeof b!="string"?!1:(typeof o=="string"&&(o={"=":o}),o=o||{},m=o["="]||o["*"]||o[">"]||o["<"],b===m?!0:A!==o["="]?!1:(m=o["*"]||o[">"]||o["<"],b.slice(0,(m||"").length)===m?!0:A!==o["*"]?!1:A!==o[">"]&&A!==o["<"]?b>=o[">"]&&b<=o["<"]:A!==o[">"]&&b>=o[">"]||A!==o["<"]&&b<=o["<"]))},j.text.hash=j.text.hash||function(b,o){if(v("text.hash"),typeof b=="string"){if(o=o||0,!b.length)return o;for(var m=0,A=b.length,E;m<A;++m)E=b.charCodeAt(m),o=(o<<5)-o+E,o|=0;return o}},j.list=j.list||{is:function(b){return v("list"),b instanceof Array}},j.list.slit=j.list.slit||Array.prototype.slice,j.list.sort=j.list.sort||function(b){return v("list.sort"),function(o,m){return!o||!m?0:(o=o[b],m=m[b],o<m?-1:o>m?1:0)}},j.list.map=j.list.map||function(b,o,m){return v("list.map"),T(b,o,m)},j.list.index=1,j.obj=j.boj||{is:function(b){return v("obj"),b?b instanceof Object&&b.constructor===Object||Object.prototype.toString.call(b).match(/^\[object (\w+)\]$/)[1]==="Object":!1}},j.obj.put=j.obj.put||function(b,o,m){return v("obj.put"),(b||{})[o]=m,b},j.obj.has=j.obj.has||function(b,o){return v("obj.has"),b&&Object.prototype.hasOwnProperty.call(b,o)},j.obj.del=j.obj.del||function(b,o){if(v("obj.del"),!!b)return b[o]=null,delete b[o],b},j.obj.as=j.obj.as||function(b,o,m,A){return v("obj.as"),b[o]=b[o]||(A===m?{}:m)},j.obj.ify=j.obj.ify||function(b){if(v("obj.ify"),l(b))return b;try{b=JSON.parse(b)}catch{b={}}return b},function(){var b;function o(m,A){_(this,A)&&b!==this[A]||(this[A]=m)}j.obj.to=j.obj.to||function(m,A){return v("obj.to"),A=A||{},T(m,o,A),A}}(),j.obj.copy=j.obj.copy||function(b){return v("obj.copy"),b&&JSON.parse(JSON.stringify(b))},function(){function b(o,m){var A=this.n,E;if(!(A&&(m===A||l(A)&&_(A,m)))&&E!==m)return!0}j.obj.empty=j.obj.empty||function(o,m){return v("obj.empty"),o?!T(o,b,{n:m}):!0}}(),function(){function b(A,E){if(arguments.length===2){b.r=b.r||{},b.r[A]=E;return}b.r=b.r||[],b.r.push(A)}var o=Object.keys,m;Object.keys=Object.keys||function(A){return m(A,function(E,O,D){D(O)})},j.obj.map=m=j.obj.map||function(A,E,O){v("obj.map");var D,G=0,N,I,P,U,J=typeof E=="function";if(b.r=D,o&&l(A)&&(P=o(A),U=!0),O=O||{},$(A)||P)for(N=(P||A).length;G<N;G++){var q=G+j.list.index;if(J){if(I=U?E.call(O,A[P[G]],P[G],b):E.call(O,A[G],q,b),I!==D)return I}else if(E===A[U?P[G]:G])return P?P[G]:q}else for(G in A)if(J){if(_(A,G)&&(I=O?E.call(O,A[G],G,b):E(A[G],G,b),I!==D))return I}else if(E===A[G])return G;return J?b.r:j.list.index?0:-1}}(),j.time=j.time||{},j.time.is=j.time.is||function(b){return v("time"),b?b instanceof Date:+new Date().getTime()};var a=j.fn.is,$=j.list.is,e=j.obj,l=e.is,_=e.has,T=e.map,n={};n.is=function(b){return v("val.is"),b===C?!1:b===null?!0:b===1/0?!1:w(b)||s(b)||t(b)?!0:n.link.is(b)||!1},n.link=n.rel={_:"#"},function(){n.link.is=function(o){if(v("val.link.is"),o&&o[f]&&!o._&&l(o)){var m={};if(T(o,b,m),m.id)return m.id}return!1};function b(o,m){var A=this;if(A.id)return A.id=!1;if(m==f&&w(o))A.id=o;else return A.id=!1}}(),n.link.ify=function(b){return v("val.link.ify"),x({},f,b)},j.obj.has._=".";var f=n.link._,C,s=j.bi.is,t=j.num.is,w=j.text.is,e=j.obj,l=e.is,x=e.put,T=e.map;j.val=j.val||n;var c={_:"_"};c.soul=function(b,o){return v("node.soul"),b&&b._&&b._[o||i]},c.soul.ify=function(b,o){return v("node.soul.ify"),o=typeof o=="string"?{soul:o}:o||{},b=b||{},b._=b._||{},b._[i]=o.soul||b._[i]||r(),b},c.soul._=n.link._,function(){c.is=function(o,m,A){v("node.is");var E;return l(o)&&(E=c.soul(o))?!T(o,b,{as:A,cb:m,s:E,n:o}):!1};function b(o,m){if(m!==c._){if(!n.is(o))return!0;this.cb&&this.cb.call(this.as,o,m,this.n,this.s)}}}(),function(){c.ify=function(o,m,A){return v("node.ify"),m?typeof m=="string"?m={soul:m}:typeof m=="function"&&(m={map:m}):m={},m.map&&(m.node=m.map.call(A,o,C,m.node||{})),(m.node=c.soul.ify(m.node||{},m))&&T(o,b,{o:m,as:A}),m.node};function b(o,m){var A=this.o,E,O;if(A.map){E=A.map.call(this.as,o,""+m,A.node),O===E?y(A.node,m):A.node&&(A.node[m]=E);return}n.is(o)&&(A.node[m]=o)}}();var e=j.obj,l=e.is,y=e.del,T=e.map,u=j.text,r=u.random,i=c.soul._,C;j.node=j.node||c;var h=j.state;h.lex=function(){return v("state.lex"),h().toString(36).replace(".","")},h.to=function(b,o,m){v("state.to");var A=(b||{})[o];return l(A)&&(A=B(A)),h.ify(m,o,h.is(b,o),A,c.soul(b))},function(){h.map=function(o,m,A){v("state.map");var E,O=l(O=o||m)?O:null;return o=a(o=o||m)?o:null,O&&!o?(m=t(m)?m:h(),O[d]=O[d]||{},T(O,b,{o:O,s:m}),O):(A=A||l(m)?m:E,m=t(m)?m:h(),function(D,G,N,I){if(!o)return b.call({o:N,s:m},D,G),D;o.call(A||this||{},D,G,N,I),!(_(N,G)&&E===N[G])&&b.call({o:N,s:m},D,G)})};function b(o,m){d!==m&&h.ify(this.o,m,this.s)}}();var e=j.obj;e.as;var _=e.has,l=e.is,T=e.map,B=e.copy,k=j.num,t=k.is,p=j.fn,a=p.is,d=c._,C,S={};(function(){S.is=function(m,A,E,O){return v("graph.is"),!m||!l(m)||g(m)?!1:!T(m,b,{cb:A,fn:E,as:O})};function b(m,A){if(!m||A!==c.soul(m)||!c.is(m,this.fn,this.as))return!0;this.cb&&(o.n=m,o.as=this.as,this.cb.call(o.as,m,A,o))}function o(m){m&&c.is(o.n,m,o.as)}})(),function(){S.ify=function(O,D,G){v("graph.ify");var N={path:[],obj:O};return D?typeof D=="string"?D={soul:D}:typeof D=="function"&&(D.map=D):D={},typeof G=="string"&&(D.soul=D.soul||G,G=C),D.soul&&(N.link=n.link.ify(D.soul)),D.shell=(G||{}).shell,D.graph=D.graph||{},D.seen=D.seen||[],D.as=D.as||G,b(D,N),D.root=N.node,D.graph};function b(O,D){var G;return(G=E(O,D))?G:(D.env=O,D.soul=m,c.ify(D.obj,o,D)&&(D.link=D.link||n.link.ify(c.soul(D.node)),D.obj!==O.shell&&(O.graph[n.link.is(D.link)]=D.node)),D)}function o(O,D,G){var N=this,I=N.env,P,U;if(c._===D&&_(O,n.link._))return G._;if(P=A(O,D,G,N,I)){if(D||(N.node=N.node||G||{},_(O,c._)&&c.soul(O)&&(N.node._=B(O._)),N.node=c.soul.ify(N.node,n.link.is(N.link)),N.link=N.link||n.link.ify(c.soul(N.node))),(U=I.map)&&(U.call(I.as||{},O,D,G,N),_(G,D))){if(O=G[D],C===O){y(G,D);return}if(!(P=A(O,D,G,N,I)))return}if(!D)return N.node;if(P===!0)return O;if(U=b(I,{obj:O,path:N.path.concat(D)}),!!U.node)return U.link}}function m(O){var D=this,G=n.link.is(D.link),N=D.env.graph;D.link=D.link||n.link.ify(O),D.link[n.link._]=O,D.node&&D.node[c._]&&(D.node[c._][n.link._]=O),_(N,G)&&(N[O]=N[G],y(N,G))}function A(O,D,G,N,I){var P;if(n.is(O))return!0;if(l(O))return 1;if(P=I.invalid)return O=P.call(I.as||{},O,D,G),A(O,D,G,N,I);I.err="Invalid value at '"+N.path.concat(D).join(".")+"'!",j.list.is(O)&&(I.err+=" Use `.set(item)` instead of an Array.")}function E(O,D){for(var G=O.seen,N=G.length,I;N--;)if(I=G[N],D.obj===I.obj)return I;G.push(D)}}(),S.node=function(b){v("graph.node");var o=c.soul(b);if(o)return x({},o,b)},function(){S.to=function(o,m,A){if(v("graph.to"),!!o){var E={};return A=A||{seen:{}},T(o[m],b,{obj:E,graph:o,opt:A}),E}};function b(o,m){var A,E;if(c._===m){if(g(o,n.link._))return;this.obj[m]=B(o);return}if(!(A=n.link.is(o))){this.obj[m]=o;return}if(E=this.opt.seen[A]){this.obj[m]=E;return}this.obj[m]=this.opt.seen[A]=S.to(this.graph,A,this.opt)}}();var a=j.fn.is,e=j.obj,l=e.is,y=e.del,_=e.has,g=e.empty,x=e.put,T=e.map,B=e.copy,C;j.graph=j.graph||S}}()}(X)),X.exports}var St=st();const _t=at(St);var Z={exports:{}};Z.exports;var it;function xt(){return it||(it=1,function(R){(function(){function v($,n){return n?ft($):$.slice?v[f($)]:function(s,w){$(s={exports:{}}),v[f(w)]=s.exports};function f(s){return s.split("/").slice(-1).toString().replace(".js","")}}var j=R;v(function($){typeof self<"u"&&($.window=self),typeof window<"u"&&($.window=window);var n=$.window||$,f,s=n.SEA||{};(s.window=$.window)&&(s.window.SEA=s);try{f+""!=typeof j&&(j.exports=s)}catch{}$.exports=s})(v,"./root"),v(function($){var n=v("./root");try{n.window&&location.protocol.indexOf("s")<0&&location.host.indexOf("localhost")<0&&!/^127\.\d+\.\d+\.\d+$/.test(location.hostname)&&location.protocol.indexOf("file:")<0&&(console.warn("HTTPS needed for WebCrypto in SEA, redirecting..."),location.protocol="https:")}catch{}})(v,"./https"),v(function($){var n;if(n+""==typeof btoa){if(n+""==typeof Buffer)try{V.Buffer=v("buffer",1).Buffer}catch{console.log("Please `npm install buffer` or add it to your package.json !")}V.btoa=function(f){return Buffer.from(f,"binary").toString("base64")},V.atob=function(f){return Buffer.from(f,"base64").toString("binary")}}})(v,"./base64"),v(function($){v("./base64");function n(){}Object.assign(n,{from:Array.from}),n.prototype=Object.create(Array.prototype),n.prototype.toString=function(f,s,w){f=f||"utf8",s=s||0;const c=this.length;if(f==="hex"){const u=new Uint8Array(this);return[...Array((w&&w+1||c)-s).keys()].map(r=>u[r+s].toString(16).padStart(2,"0")).join("")}if(f==="utf8")return Array.from({length:(w||c)-s},(u,r)=>String.fromCharCode(this[r+s])).join("");if(f==="base64")return btoa(this)},$.exports=n})(v,"./array"),v(function($){v("./base64");var n=v("./array");function f(...s){return console.warn("new SafeBuffer() is depreciated, please use SafeBuffer.from()"),f.from(...s)}f.prototype=Object.create(Array.prototype),Object.assign(f,{from(){if(!Object.keys(arguments).length||arguments[0]==null)throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.");const s=arguments[0];let w;if(typeof s=="string"){const u=arguments[1]||"utf8";if(u==="hex"){const r=s.match(/([\da-fA-F]{2})/g).map(i=>parseInt(i,16));if(!r||!r.length)throw new TypeError("Invalid first argument for type 'hex'.");w=n.from(r)}else if(u==="utf8"||u==="binary"){const r=s.length,i=new Uint16Array(r);Array.from({length:r},(h,k)=>i[k]=s.charCodeAt(k)),w=n.from(i)}else if(u==="base64"){const r=atob(s),i=r.length,h=new Uint8Array(i);Array.from({length:i},(k,t)=>h[t]=r.charCodeAt(t)),w=n.from(h)}else u==="binary"?w=n.from(s):console.info("SafeBuffer.from unknown encoding: "+u);return w}if(s.byteLength,s.byteLength?s.byteLength:s.length){let u;return s instanceof ArrayBuffer&&(u=new Uint8Array(s)),n.from(u||s)}},alloc(s,w=0){return n.from(new Uint8Array(Array.from({length:s},()=>w)))},allocUnsafe(s){return n.from(new Uint8Array(Array.from({length:s})))},concat(s){if(!Array.isArray(s))throw new TypeError("First argument must be Array containing ArrayBuffer or Uint8Array instances.");return n.from(s.reduce((w,c)=>w.concat(Array.from(c)),[]))}}),f.prototype.from=f.from,f.prototype.toString=n.prototype.toString,$.exports=f})(v,"./buffer"),v(function($){const n=v("./root"),f={Buffer:v("./buffer")};var s={},w;if(JSON.parseAsync=JSON.parseAsync||function(u,r,i){var h;try{r(h,JSON.parse(u,i))}catch(k){r(k)}},JSON.stringifyAsync=JSON.stringifyAsync||function(u,r,i,h){var k;try{r(k,JSON.stringify(u,i,h))}catch(t){r(t)}},f.parse=function(u,r){return new Promise(function(i,h){JSON.parseAsync(u,function(k,t){k?h(k):i(t)},r)})},f.stringify=function(u,r,i){return new Promise(function(h,k){JSON.stringifyAsync(u,function(t,p){t?k(t):h(p)},r,i)})},n.window&&(f.crypto=n.window.crypto||n.window.msCrypto,f.subtle=(f.crypto||s).subtle||(f.crypto||s).webkitSubtle,f.TextEncoder=n.window.TextEncoder,f.TextDecoder=n.window.TextDecoder,f.random=u=>f.Buffer.from(f.crypto.getRandomValues(new Uint8Array(f.Buffer.alloc(u))))),!f.TextDecoder){const{TextEncoder:u,TextDecoder:r}=v((w+""==typeof j?".":"")+"./lib/text-encoding",1);f.TextDecoder=r,f.TextEncoder=u}if(!f.crypto)try{var c=v("crypto",1);Object.assign(f,{crypto:c,random:r=>f.Buffer.from(c.randomBytes(r))});const{Crypto:u}=v("@peculiar/webcrypto",1);f.ossl=f.subtle=new u({directory:"ossl"}).subtle}catch{console.log("Please `npm install @peculiar/webcrypto` or add it to your package.json !")}$.exports=f})(v,"./shim"),v(function($){var n=v("./root"),f=v("./shim"),s={};s.pbkdf2={hash:{name:"SHA-256"},iter:1e5,ks:64},s.ecdsa={pair:{name:"ECDSA",namedCurve:"P-256"},sign:{name:"ECDSA",hash:{name:"SHA-256"}}},s.ecdh={name:"ECDH",namedCurve:"P-256"},s.jwk=function(w,c){w=w.split(".");var u=w[0],r=w[1],i={kty:"EC",crv:"P-256",x:u,y:r,ext:!0};return i.key_ops=c?["sign"]:["verify"],c&&(i.d=c),i},s.keyToJwk=function(w){return{kty:"oct",k:w.toString("base64").replace(/\+/g,"-").replace(/\//g,"_").replace(/\=/g,""),ext:!1,alg:"A256GCM"}},s.recall={validity:12*60*60,hook:function(w){return w}},s.check=function(w){return typeof w=="string"&&w.slice(0,4)==="SEA{"},s.parse=async function(c){try{var u=typeof c=="string";return u&&c.slice(0,4)==="SEA{"&&(c=c.slice(3)),u?await f.parse(c):c}catch{}return c},n.opt=s,$.exports=s})(v,"./settings"),v(function($){var n=v("./shim");$.exports=async function(f,s){var w=typeof f=="string"?f:await n.stringify(f),c=await n.subtle.digest({name:s||"SHA-256"},new n.TextEncoder().encode(w));return n.Buffer.from(c)}})(v,"./sha256"),v(function($){const n=v("./shim"),f=n.subtle,s=n.ossl?n.ossl:f,w=c=>s.digest({name:"SHA-1"},new ArrayBuffer(c));$.exports=w})(v,"./sha1"),v(function($){var n=v("./root"),f=v("./shim"),s=v("./settings"),w=v("./sha256"),c;n.work=n.work||(async(u,r,i,h)=>{try{var k=(r||{}).epub||r;if(h=h||{},k instanceof Function&&(i=k,k=c),u=typeof u=="string"?u:await f.stringify(u),(h.name||"").toLowerCase().slice(0,3)==="sha"){var t=f.Buffer.from(await w(u,h.name),"binary").toString(h.encode||"base64");if(i)try{i(t)}catch(a){console.log(a)}return t}k=k||f.random(9);var p=await(f.ossl||f.subtle).importKey("raw",new f.TextEncoder().encode(u),{name:h.name||"PBKDF2"},!1,["deriveBits"]),d=await(f.ossl||f.subtle).deriveBits({name:h.name||"PBKDF2",iterations:h.iterations||s.pbkdf2.iter,salt:new f.TextEncoder().encode(h.salt||k),hash:h.hash||s.pbkdf2.hash},p,h.length||s.pbkdf2.ks*8);u=f.random(u.length);var S=f.Buffer.from(d,"binary").toString(h.encode||"base64");if(i)try{i(S)}catch(a){console.log(a)}return S}catch(a){if(console.log(a),n.err=a,n.throw)throw a;i&&i();return}}),$.exports=n.work})(v,"./work"),v(function($){var n=v("./root"),f=v("./shim");v("./settings"),n.name=n.name||(async(s,w)=>{try{if(s)try{s()}catch(c){console.log(c)}return}catch(c){if(console.log(c),n.err=c,n.throw)throw c;s&&s();return}}),n.pair=n.pair||(async(s,w)=>{try{var c=f.ossl||f.subtle,u=await f.subtle.generateKey({name:"ECDSA",namedCurve:"P-256"},!0,["sign","verify"]).then(async h=>{var k={};k.priv=(await f.subtle.exportKey("jwk",h.privateKey)).d;var t=await f.subtle.exportKey("jwk",h.publicKey);return k.pub=t.x+"."+t.y,k});try{var r=await c.generateKey({name:"ECDH",namedCurve:"P-256"},!0,["deriveKey"]).then(async h=>{var k={};k.epriv=(await c.exportKey("jwk",h.privateKey)).d;var t=await c.exportKey("jwk",h.publicKey);return k.epub=t.x+"."+t.y,k})}catch(h){if(n.window)throw h;if(h=="Error: ECDH is not a supported algorithm")console.log("Ignoring ECDH...");else throw h}r=r||{};var i={pub:u.pub,priv:u.priv,epub:r.epub,epriv:r.epriv};if(s)try{s(i)}catch(h){console.log(h)}return i}catch(h){if(console.log(h),n.err=h,n.throw)throw h;s&&s();return}}),$.exports=n.pair})(v,"./pair"),v(function($){var n=v("./root"),f=v("./shim"),s=v("./settings"),w=v("./sha256"),c;n.sign=n.sign||(async(u,r,i,h)=>{try{if(h=h||{},!(r||h).priv){if(!n.I)throw"No signing key.";r=await n.I(null,{what:u,how:"sign",why:h.why})}if(c===u)throw"`undefined` not allowed.";var k=await s.parse(u),t=h.check=h.check||k;if(n.verify&&(n.opt.check(t)||t&&t.s&&t.m)&&c!==await n.verify(t,r)){var l=await s.parse(t);if(h.raw||(l="SEA"+await f.stringify(l)),i)try{i(l)}catch(_){console.log(_)}return l}var p=r.pub,d=r.priv,S=s.jwk(p,d),a=await w(k),e=await(f.ossl||f.subtle).importKey("jwk",S,{name:"ECDSA",namedCurve:"P-256"},!1,["sign"]).then(y=>(f.ossl||f.subtle).sign({name:"ECDSA",hash:{name:"SHA-256"}},y,new Uint8Array(a))),l={m:k,s:f.Buffer.from(e,"binary").toString(h.encode||"base64")};if(h.raw||(l="SEA"+await f.stringify(l)),i)try{i(l)}catch(y){console.log(y)}return l}catch(y){if(console.log(y),n.err=y,n.throw)throw y;i&&i();return}}),$.exports=n.sign})(v,"./sign"),v(function($){var n=v("./root"),f=v("./shim"),s=v("./settings"),w=v("./sha256"),c;n.verify=n.verify||(async(i,h,k,t)=>{try{var p=await s.parse(i);if(h===!1){var d=await s.parse(p.m);if(k)try{k(d)}catch(T){console.log(T)}return d}t=t||{};var S=h.pub||h,a=n.opt.slow_leak?await n.opt.slow_leak(S):await(f.ossl||f.subtle).importKey("jwk",s.jwk(S),{name:"ECDSA",namedCurve:"P-256"},!1,["verify"]),e=await w(p.m),l,y,_,g;try{if(l=f.Buffer.from(p.s,t.encode||"base64"),y=new Uint8Array(l),_=await(f.ossl||f.subtle).verify({name:"ECDSA",hash:{name:"SHA-256"}},a,y,new Uint8Array(e)),!_)throw"Signature did not match."}catch{if(n.opt.fallback)return await n.opt.fall_verify(i,h,k,t)}var x=_?await s.parse(p.m):c;if(k)try{k(x)}catch(T){console.log(T)}return x}catch(T){if(console.log(T),n.err=T,n.throw)throw T;k&&k();return}}),$.exports=n.verify;var u={};n.opt.slow_leak=i=>{if(u[i])return u[i];var h=s.jwk(i);return u[i]=(f.ossl||f.subtle).importKey("jwk",h,{name:"ECDSA",namedCurve:"P-256"},!1,["verify"]),u[i]};var r=n.opt;n.opt.fall_verify=async function(i,h,k,t,p){if(p===n.opt.fallback)throw"Signature did not match";p=p||1;var d=i||"";i=n.opt.unpack(i)||i;var S=await s.parse(i),a=h.pub||h,e=await n.opt.slow_leak(a),l=p<=n.opt.fallback?f.Buffer.from(await f.subtle.digest({name:"SHA-256"},new f.TextEncoder().encode(await s.parse(S.m)))):await w(S.m),y,_,g;try{if(y=f.Buffer.from(S.s,t.encode||"base64"),_=new Uint8Array(y),g=await(f.ossl||f.subtle).verify({name:"ECDSA",hash:{name:"SHA-256"}},e,_,new Uint8Array(l)),!g)throw"Signature did not match."}catch{try{y=f.Buffer.from(S.s,"utf8"),_=new Uint8Array(y),g=await(f.ossl||f.subtle).verify({name:"ECDSA",hash:{name:"SHA-256"}},e,_,new Uint8Array(l))}catch{if(!g)throw"Signature did not match."}}var x=g?await s.parse(S.m):c;if(r.fall_soul=d["#"],r.fall_key=d["."],r.fall_val=i,r.fall_state=d[">"],k)try{k(x)}catch(T){console.log(T)}return x},n.opt.fallback=2})(v,"./verify"),v(function($){var n=v("./shim"),f=v("./settings"),s=v("./sha256");const w=async(c,u,r)=>{const i=c+(u||n.random(8)).toString("utf8"),h=n.Buffer.from(await s(i),"binary"),k=f.keyToJwk(h);return await n.subtle.importKey("jwk",k,{name:"AES-GCM"},!1,["encrypt","decrypt"])};$.exports=w})(v,"./aeskey"),v(function($){var n=v("./root"),f=v("./shim");v("./settings");var s=v("./aeskey"),w;n.encrypt=n.encrypt||(async(c,u,r,i)=>{try{i=i||{};var h=(u||i).epriv||u;if(w===c)throw"`undefined` not allowed.";if(!h){if(!n.I)throw"No encryption key.";u=await n.I(null,{what:c,how:"encrypt",why:i.why}),h=u.epriv||u}var k=typeof c=="string"?c:await f.stringify(c),t={s:f.random(9),iv:f.random(15)},p=await s(h,t.s,i).then(S=>f.subtle.encrypt({name:i.name||"AES-GCM",iv:new Uint8Array(t.iv)},S,new f.TextEncoder().encode(k))),d={ct:f.Buffer.from(p,"binary").toString(i.encode||"base64"),iv:t.iv.toString(i.encode||"base64"),s:t.s.toString(i.encode||"base64")};if(i.raw||(d="SEA"+await f.stringify(d)),r)try{r(d)}catch(S){console.log(S)}return d}catch(S){if(console.log(S),n.err=S,n.throw)throw S;r&&r();return}}),$.exports=n.encrypt})(v,"./encrypt"),v(function($){var n=v("./root"),f=v("./shim"),s=v("./settings"),w=v("./aeskey");n.decrypt=n.decrypt||(async(c,u,r,i)=>{try{i=i||{};var h=(u||i).epriv||u;if(!h){if(!n.I)throw"No decryption key.";u=await n.I(null,{what:c,how:"decrypt",why:i.why}),h=u.epriv||u}var k=await s.parse(c),t,p,d;try{t=f.Buffer.from(k.s,i.encode||"base64"),p=f.Buffer.from(k.iv,i.encode||"base64"),d=f.Buffer.from(k.ct,i.encode||"base64");var S=await w(h,t,i).then(e=>f.subtle.decrypt({name:i.name||"AES-GCM",iv:new Uint8Array(p),tagLength:128},e,new Uint8Array(d)))}catch{if(i.encode==="utf8")throw"Could not decrypt";if(n.opt.fallback)return i.encode="utf8",await n.decrypt(c,u,r,i)}var a=await s.parse(new f.TextDecoder("utf8").decode(S));if(r)try{r(a)}catch(e){console.log(e)}return a}catch(e){if(console.log(e),n.err=e,n.throw)throw e;r&&r();return}}),$.exports=n.decrypt})(v,"./decrypt"),v(function($){var n=v("./root"),f=v("./shim");v("./settings"),n.secret=n.secret||(async(w,c,u,r)=>{try{if(r=r||{},!c||!c.epriv||!c.epub){if(!n.I)throw"No secret mix.";c=await n.I(null,{what:w,how:"secret",why:r.why})}var i=w.epub||w,h=c.epub,k=c.epriv,t=f.ossl||f.subtle,p=s(i),d=Object.assign({public:await t.importKey(...p,!0,[])},{name:"ECDH",namedCurve:"P-256"}),S=s(h,k),a=await t.importKey(...S,!1,["deriveBits"]).then(async l=>{var y=await t.deriveBits(d,l,256),_=new Uint8Array(y),g=await t.importKey("raw",_,{name:"AES-GCM",length:256},!0,["encrypt","decrypt"]);return t.exportKey("jwk",g).then(({k:x})=>x)}),e=a;if(u)try{u(e)}catch(l){console.log(l)}return e}catch(l){if(console.log(l),n.err=l,n.throw)throw l;u&&u();return}});var s=(w,c)=>{var[u,r]=w.split("."),i=c?{d:c}:{};return["jwk",Object.assign(i,{x:u,y:r,kty:"EC",crv:"P-256",ext:!0}),{name:"ECDH",namedCurve:"P-256"}]};$.exports=n.secret})(v,"./secret"),v(function($){var n=v("./root");n.certify=n.certify||(async(f,s={},w,c,u={})=>{try{if(console.log("SEA.certify() is an early experimental community supported method that may change API behavior without warning in any future version."),f=(()=>{var e=[];if(f){if((typeof f=="string"||Array.isArray(f))&&f.indexOf("*")>-1)return"*";if(typeof f=="string")return f;if(Array.isArray(f)){if(f.length===1&&f[0])return typeof f[0]=="object"&&f[0].pub?f[0].pub:typeof f[0]=="string"?f[0]:null;f.map(l=>{typeof l=="string"?e.push(l):typeof l=="object"&&l.pub&&e.push(l.pub)})}return typeof f=="object"&&f.pub?f.pub:e.length>0?e:null}})(),!f)return console.log("No certificant found.");const i=u.expiry&&(typeof u.expiry=="number"||typeof u.expiry=="string")?parseFloat(u.expiry):null,h=(s||{}).read?s.read:null,k=(s||{}).write?s.write:typeof s=="string"||Array.isArray(s)||s["+"]||s["#"]||s["."]||s["="]||s["*"]||s[">"]||s["<"]?s:null,t=(u||{}).block||(u||{}).blacklist||(u||{}).ban||{},p=t.read&&(typeof t.read=="string"||(t.read||{})["#"])?t.read:null,d=typeof t=="string"?t:t.write&&(typeof t.write=="string"||t.write["#"])?t.write:null;if(!h&&!k)return console.log("No policy found.");const S=JSON.stringify({c:f,...i?{e:i}:{},...h?{r:h}:{},...k?{w:k}:{},...p?{rb:p}:{},...d?{wb:d}:{}});var r=await n.sign(S,w,null,{raw:1});if(u.raw||(r="SEA"+JSON.stringify(r)),c)try{c(r)}catch(e){console.log(e)}return r}catch(i){if(n.err=i,n.throw)throw i;c&&c();return}}),$.exports=n.certify})(v,"./certify"),v(function($){var n=v("./shim"),f=v("./root");f.work=v("./work"),f.sign=v("./sign"),f.verify=v("./verify"),f.encrypt=v("./encrypt"),f.decrypt=v("./decrypt"),f.certify=v("./certify"),f.random=f.random||n.random,f.Buffer=f.Buffer||v("./buffer"),f.keyid=f.keyid||(async s=>{try{const w=n.Buffer.concat(s.replace(/-/g,"+").replace(/_/g,"/").split(".").map(i=>n.Buffer.from(i,"base64"))),c=n.Buffer.concat([n.Buffer.from([153,w.length/256,w.length%256]),w]),u=await sha1hash(c),r=n.Buffer.from(u,"binary");return r.toString("hex",r.length-8)}catch(w){throw console.log(w),w}}),((f.window||{}).GUN||{}).SEA=f,$.exports=f})(v,"./sea"),v(function($){var n=v("./sea"),f,s;n.window?f=n.window.GUN||{chain:{}}:f=v((s+""==typeof j?".":"")+"./gun",1),n.GUN=f;function w(u){this._={$:this}}w.prototype=function(){function u(){}return u.prototype=f.chain,new u}(),w.prototype.constructor=w,f.chain.user=function(u){var r=this,h=r.back(-1),i;if(u)return u=n.opt.pub((u._||"")["#"])||u,h.get("~"+u);if(i=h.back("user"))return i;var h=h._,k=h,t=k.opt.uuid||c;return(k=(i=k.user=r.chain(new w))._).opt={},k.opt.uuid=function(p){var d=t(),S=h.user;return!S||!(S=S.is)||!(S=S.pub)||(d="~"+S+"/"+d,p&&p.call&&p(null,d)),d},i};function c(){return f.state().toString(36).replace(".","")}f.User=w,w.GUN=f,w.SEA=f.SEA=n,$.exports=w})(v,"./user"),v(function($){var n,f=""+n!=typeof GUN?GUN||{chain:{}}:v((""+n==typeof j?".":"")+"./gun",1);f.chain.then=function(s,w){var c=this,u=new Promise(function(r,i){c.once(r,w)});return s?u.then(s):u}})(v,"./then"),v(function($){var n=v("./user"),f=n.SEA,s=n.GUN,w=function(){};n.prototype.create=function(...c){var u=typeof c[0]=="object"&&(c[0].pub||c[0].epub)?c[0]:typeof c[1]=="object"&&(c[1].pub||c[1].epub)?c[1]:null,r=u&&(u.pub||u.epub)?u.pub:typeof c[0]=="string"?c[0]:null,i=u&&(u.pub||u.epub)?u:r&&typeof c[1]=="string"?c[1]:null,h=c.filter(e=>typeof e=="function")[0]||null,k=c&&c.length>1&&typeof c[c.length-1]=="object"?c[c.length-1]:{},t=this,p=t._,d=t.back(-1);if(h=h||w,k=k||{},k.check!==!1){var S;if(r||(S="No user."),(i||"").length<8&&(S="Password too short!"),S)return h({err:s.log(S)}),t}if(p.ing)return(h||w)({err:s.log("User is already being created or authenticated!"),wait:!0}),t;p.ing=!0;var a={};return a.a=function(e){if(a.pubs=e,e&&!k.already){var l={err:s.log("User already created!")};p.ing=!1,(h||w)(l),t.leave();return}a.salt=String.random(64),f.work(i,a.salt,a.b)},a.b=function(e){a.proof=e,u?a.c(u):f.pair(a.c)},a.c=function(e){var l;a.pair=e||{},(l=p.root.user)&&(l._.sea=e,l.is={pub:e.pub,epub:e.epub,alias:r}),a.data={pub:e.pub},a.d()},a.d=function(){a.data.alias=r,a.e()},a.e=function(){a.data.epub=a.pair.epub,f.encrypt({priv:a.pair.priv,epriv:a.pair.epriv},a.proof,a.f,{raw:1})},a.f=function(e){a.data.auth=JSON.stringify({ek:e,s:a.salt}),a.g(a.data.auth)},a.g=function(e){var l;a.data.auth=a.data.auth||e,d.get(l="~"+a.pair.pub).put(a.data).on(a.h);var y={};y[l]={"#":l},d.get("~@"+r).put(y).get(l).on(a.i)},a.h=function(e,l,y,_){_.off(),a.h.ok=1,a.i()},a.i=function(e,l,y,_){_&&(a.i.ok=1,_.off()),!(!a.h.ok||!a.i.ok)&&(p.ing=!1,h({ok:0,pub:a.pair.pub}),w===h&&(u?t.auth(u):t.auth(r,i)))},d.get("~@"+r).once(a.a),t},n.prototype.leave=function(c,u){var r=this,i=r.back(-1)._.user;if(i&&(delete i.is,delete i._.is,delete i._.sea),f.window)try{var h={};h=f.window.sessionStorage,delete h.recall,delete h.pair}catch{}return r}})(v,"./create"),v(function($){var n=v("./user"),f=n.SEA,s=n.GUN,w=function(){};n.prototype.auth=function(...u){var r=typeof u[0]=="object"&&(u[0].pub||u[0].epub)?u[0]:typeof u[1]=="object"&&(u[1].pub||u[1].epub)?u[1]:null,i=!r&&typeof u[0]=="string"?u[0]:null,h=(i||r&&!(r.priv&&r.epriv))&&typeof u[1]=="string"?u[1]:null,k=u.filter(y=>typeof y=="function")[0]||null,t=u&&u.length>1&&typeof u[u.length-1]=="object"?u[u.length-1]:{},p=this,d=p._,S=p.back(-1);if(d.ing)return(k||w)({err:s.log("User is already being created or authenticated!"),wait:!0}),p;d.ing=!0;var a={},e,l=9;return a.a=function(y){if(!y)return a.b();if(!y.pub){var _=[];return Object.keys(y).forEach(function(g){g!="_"&&_.push(y[g])}),a.b(_)}if(a.name)return a.f(y);a.c((a.data=y).auth)},a.b=function(y){var _=(a.list=(a.list||[]).concat(y||[])).shift();if(e===_){if(a.name)return a.err("Your user account is not published for dApps to access, please consider syncing it online, or allowing local access by adding your device as a peer.");if(i&&l--){S.get("~@"+i).once(a.a);return}return a.err("Wrong user or password.")}S.get(_).once(a.a)},a.c=function(y){if(e===y)return a.b();if(typeof y=="string")return a.c(c(y));f.work(h,(a.auth=y).s,a.d,a.enc)},a.d=function(y){f.decrypt(a.auth.ek,y,a.e,a.enc)},a.e=function(y){if(e===y)return a.enc?(a.enc=null,a.b()):(a.enc={encode:"utf8"},a.c(a.auth));a.half=y,a.f(a.data)},a.f=function(y){var _=a.half||{},g=a.data||{};a.g(a.lol={pub:y.pub||g.pub,epub:y.epub||g.epub,priv:y.priv||_.priv,epriv:y.epriv||_.epriv})},a.g=function(y){if(!y||!y.pub||!y.epub)return a.b();a.pair=y;var _=S._.user,g=_._;g.tag;var x=g.opt;g=_._=S.get("~"+y.pub)._,g.opt=x,_.is={pub:y.pub,epub:y.epub,alias:i||y.pub},g.sea=a.pair,d.ing=!1;try{h&&e==(c(d.root.graph["~"+y.pub].auth)||"")[":"]&&(t.shuffle=t.change=h)}catch{}if(t.change?a.z():(k||w)(g),f.window&&(p.back("user")._.opt||t).remember)try{var T={};T=f.window.sessionStorage,T.recall=!0,T.pair=JSON.stringify(y)}catch{}try{S._.tag.auth?S._.on("auth",g):setTimeout(function(){S._.on("auth",g)},1)}catch(B){s.log("Your 'auth' callback crashed with:",B)}},a.h=function(y){if(!y)return a.b();if(i=y.alias,i||(i=y.alias="~"+r.pub),!y.auth)return a.g(r);r=null,a.c((a.data=y).auth)},a.z=function(){a.salt=String.random(64),f.work(t.change,a.salt,a.y)},a.y=function(y){f.encrypt({priv:a.pair.priv,epriv:a.pair.epriv},y,a.x,{raw:1})},a.x=function(y){a.w(JSON.stringify({ek:y,s:a.salt}))},a.w=function(y){if(t.shuffle){console.log("migrate core account from UTF8 & shuffle");var _={};Object.keys(a.data).forEach(function(g){_[g]=a.data[g]}),delete _._,_.auth=y,S.get("~"+a.pair.pub).put(_)}S.get("~"+a.pair.pub).get("auth").put(y,k||w)},a.err=function(y){var _={err:s.log(y||"User cannot be found!")};d.ing=!1,(k||w)(_)},a.plugin=function(y){if(!(a.name=y))return a.err();var _=[y];y[0]!=="~"&&(_[1]="~"+y,_[2]="~@"+y),a.b(_)},r?r.priv&&r.epriv?a.g(r):S.get("~"+r.pub).once(a.h):i?S.get("~@"+i).once(a.a):!i&&!h&&f.name(a.plugin),p};function c(u){if(typeof u!="string")return u;try{u=JSON.parse(u)}catch{u={}}return u}})(v,"./auth"),v(function($){var n=v("./user"),f=n.SEA;n.GUN,n.prototype.recall=function(s,w){var c=this,u=c.back(-1);if(s=s||{},s&&s.sessionStorage){if(f.window)try{var r={};r=f.window.sessionStorage,r&&(u._.opt.remember=!0,(c.back("user")._.opt||s).remember=!0,(r.recall||r.pair)&&u.user().auth(JSON.parse(r.pair),w))}catch{}return c}return c}})(v,"./recall"),v(function($){var n=v("./user"),f=n.SEA,s=n.GUN,w=function(){};n.prototype.pair=function(){var c=this,u;try{u=new Proxy({DANGER:""},{get:function(r,i,h){if(!(!c.is||!(c._||"").sea))return c._.sea[i]}})}catch{}return u},n.prototype.delete=async function(c,u,r){console.log("user.delete() IS DEPRECATED AND WILL BE MOVED TO A MODULE!!!");var i=this;i.back(-1);var h=i.back("user");try{h.auth(c,u,function(k){var t=(h.is||{}).pub;h.map().once(function(){this.put(null)}),h.leave(),(r||w)({ok:0})})}catch(k){s.log("User.delete failed! Error:",k)}return i},n.prototype.alive=async function(){console.log("user.alive() IS DEPRECATED!!!");const c=this.back(-1);try{return await authRecall(c),c._.user._}catch{const r="No session!";throw s.log(r),{err:r}}},n.prototype.trust=async function(c){console.log("`.trust` API MAY BE DELETED OR CHANGED OR RENAMED, DO NOT USE!"),s.is(c)&&c.get("pub").get((u,r)=>{console.log(u,r)}),c.get("trust").get(path).put(theirPubkey)},n.prototype.grant=function(c,u){console.log("`.grant` API MAY BE DELETED OR CHANGED OR RENAMED, DO NOT USE!");var r=this,i=r.back(-1).user(),h=i._.sea,k="";return r.back(function(t){t.is||(k+=t.get||"")}),async function(){var t,p=await i.get("grant").get(h.pub).get(k).then();p=await f.decrypt(p,h),p||(p=f.random(16).toString(),t=await f.encrypt(p,h),i.get("grant").get(h.pub).get(k).put(t));var d=c.get("pub").then(),S=c.get("epub").then();d=await d,S=await S;var a=await f.secret(S,h);t=await f.encrypt(p,a),i.get("grant").get(d).get(k).put(t,u)}(),r},n.prototype.secret=function(c,u){console.log("`.secret` API MAY BE DELETED OR CHANGED OR RENAMED, DO NOT USE!");var r=this,i=r.back(-1).user(),h=i.pair(),k="";return r.back(function(t){t.is||(k+=t.get||"")}),async function(){var t,p=await i.get("trust").get(h.pub).get(k).then();p=await f.decrypt(p,h),p||(p=f.random(16).toString(),t=await f.encrypt(p,h),i.get("trust").get(h.pub).get(k).put(t)),t=await f.encrypt(c,p),r.put(t,u)}(),r},$.exports=n})(v,"./share"),v(function($){var n=v("./sea"),f=v("./settings"),s,w=(n.window||"").GUN||v((""+s==typeof j?".":"")+"./gun",1);w.on("opt",function(t){t.sea||(t.sea={own:{}},t.on("put",c,t)),this.to.next(t)});function c(t){var p=this,d=p.as,S=t.put,a=S["#"],e=S["."],l=S[":"],y=S[">"],_=t["#"],g;if(!(!a||!e)){if((t._||"").faith&&(d.opt||"").faith&&typeof t._=="function"){n.opt.pack(S,function(T){n.verify(T,!1,function(B){S["="]=n.opt.unpack(B),p.to.next(t)})});return}var x=function(T){d.on("in",{"@":_,err:t.err=T})};if((t._||"").DBG&&((t._||"").DBG.c=+new Date),0<=a.indexOf("<?")&&(g=parseFloat(a.split("<?")[1]||""),g&&y<w.state()-g*1e3)){(g=t._)&&g.stun&&g.stun--;return}if(a==="~@"){c.alias(p,t,l,e,a,d,x);return}if(a.slice(0,2)==="~@"){c.pubs(p,t,l,e,a,d,x);return}if(g=n.opt.pub(a)){c.pub(p,t,l,e,a,d,x,d.user||"",g);return}if(0<=a.indexOf("#")){c.hash(p,t,l,e,a,d,x);return}c.any(p,t,l,e,a,d,x,d.user||"")}}c.hash=function(t,p,d,S,a,e,l){n.work(d,null,function(y){function _(g){let x="";for(let T=0;T<g.length;T++)x+=T-1&1?"":String.fromCharCode(parseInt(g.substring(T-1,T+1),16));return btoa(x)}if(y&&y===S.split("#").slice(-1)[0])return t.to.next(p);if(y&&y===_(S.split("#").slice(-1)[0]))return t.to.next(p);l("Data hash not same as hash!")},{name:"SHA-256"})},c.alias=function(t,p,d,S,a,e,l){if(!d)return l("Data must exist!");if("~@"+S===r(d))return t.to.next(p);l("Alias not same!")},c.pubs=function(t,p,d,S,a,e,l){if(!d)return l("Alias must exist!");if(S===r(d))return t.to.next(p);l("Alias not same!")},c.pub=async function(t,p,d,S,a,e,l,y,_){var g;const x=await f.parse(d)||{},T=(B,C,b)=>{if(B.m&&B.s&&C&&_)return n.verify(B,_,o=>{if(s!==o&&s!==o.e&&p.put[">"]&&p.put[">"]>parseFloat(o.e))return l("Certificate expired.");if(s!==o&&o.c&&o.w&&(o.c===C||o.c.indexOf("*")>-1)){let A=a.indexOf("/")>-1?a.replace(a.substring(0,a.indexOf("/")+1),""):"";String.match=String.match||w.text.match;const E=Array.isArray(o.w)?o.w:typeof o.w=="object"||typeof o.w=="string"?[o.w]:[];for(const O of E)if(String.match(A,O["#"])&&String.match(S,O["."])||!O["."]&&String.match(A,O["#"])||!O["#"]&&String.match(S,O["."])||String.match(A?A+"/"+S:S,O["#"]||O)){if(O["+"]&&O["+"].indexOf("*")>-1&&A&&A.indexOf(C)==-1&&S.indexOf(C)==-1)return l(`Path "${A}" or key "${S}" must contain string "${C}".`);if(o.wb&&(typeof o.wb=="string"||(o.wb||{})["#"])){var m=t.as.root.$.back(-1);return typeof o.wb=="string"&&o.wb.slice(0,1)!=="~"&&(m=m.get("~"+_)),m.get(o.wb).get(C).once(D=>D&&(D===1||D===!0)?l(`Certificant ${C} blocked.`):b(o))}return b(o)}return l("Certificate verification fail.")}})};if(S==="pub"&&"~"+_===a)return d===_?t.to.next(p):l("Account not same!");if((g=y.is)&&g.pub&&!x["*"]&&!x["+"]&&(_===g.pub||_!==g.pub&&((p._.msg||{}).opt||{}).cert)){n.opt.pack(p.put,B=>{n.sign(B,y._.sea,async function(C){if(s===C)return l(n.err||"Signature fail.");if(p.put[":"]={":":g=n.opt.unpack(C.m),"~":C.s},p.put["="]=g,_===y.is.pub){(g=r(d))&&((e.sea.own[g]=e.sea.own[g]||{})[_]=1),JSON.stringifyAsync(p.put[":"],function(b,o){return b?l(b||"Stringify error."):(p.put[":"]=o,t.to.next(p))});return}if(_!==y.is.pub&&((p._.msg||{}).opt||{}).cert){const b=await f.parse(p._.msg.opt.cert);b&&b.m&&b.s&&T(b,y.is.pub,o=>{p.put[":"]["+"]=b,p.put[":"]["*"]=y.is.pub,JSON.stringifyAsync(p.put[":"],function(m,A){return m?l(m||"Stringify error."):(p.put[":"]=A,t.to.next(p))})})}},{raw:1})});return}n.opt.pack(p.put,B=>{n.verify(B,x["*"]||_,function(C){var b;if(C=n.opt.unpack(C),s===C)return l("Unverified data.");if((b=r(C))&&_===n.opt.pub(b)&&((e.sea.own[b]=e.sea.own[b]||{})[_]=1),x["+"]&&x["+"].m&&x["+"].s&&x["*"])T(x["+"],x["*"],o=>(p.put["="]=C,t.to.next(p)));else return p.put["="]=C,t.to.next(p)})})},c.any=function(t,p,d,S,a,e,l,y){if(e.opt.secure)return l("Soul missing public key at '"+S+"'.");e.on("secure",function(_){if(this.off(),!e.opt.secure)return t.to.next(_);l("Data cannot be changed.")}).on.on("secure",p)};var u=w.valid,r=function(t,p){return typeof(p=u(t))=="string"&&p};(w.state||"").ify;var i=/[^\w_-]/;n.opt.pub=function(t){if(t&&(t=t.split("~"),!(!t||!(t=t[1]))&&(t=t.split(i).slice(0,2),!(!t||t.length!=2)&&(t[0]||"")[0]!=="@")))return t=t.slice(0,2).join("."),t},n.opt.stringy=function(t){},n.opt.pack=function(t,p,d,S,a){var e,l;if(n.opt.check(t))return p(t);t&&t["#"]&&t["."]&&t[">"]&&(e=t[":"],l=1),JSON.parseAsync(l?e:t,function(y,_){var g=s!==(_||"")[":"]&&(_||"")["~"];if(!g){p(t);return}p({m:{"#":a||t["#"],".":d||t["."],":":(_||"")[":"],">":t[">"]||w.state.is(S,d)},s:g})})};var h=n.opt;n.opt.unpack=function(t,p,d){var S;if(s!==t){if(t&&s!==(S=t[":"]))return S;if(p=p||h.fall_key,!d&&h.fall_val&&(d={},d[p]=h.fall_val),!(!p||!d)){if(t===d[p]||!n.opt.check(d[p]))return t;var a=d&&d._&&d._["#"]||h.fall_soul,e=w.state.is(d,p)||h.fall_state;if(t&&t.length===4&&a===t[0]&&p===t[1]&&k(e)===k(t[3]))return t[2];if(e<n.opt.shuffle_attack)return t}}},n.opt.shuffle_attack=15463296e5;var k=Math.floor})(v,"./index")})()}(Z)),Z.exports}var At=xt();const Ot=at(At);var ot={},ut;function jt(){return ut||(ut=1,function(){var R=typeof window<"u"?window.Gun:st();R.on("opt",function(v){this.to.next(v);var j=v.opt;if(v.once||!R.Mesh||j.RTCPeerConnection===!1)return;var $;typeof window<"u"&&($=window),typeof V<"u"&&($=V),$=$||{};var n=j.RTCPeerConnection||$.RTCPeerConnection||$.webkitRTCPeerConnection||$.mozRTCPeerConnection,f=j.RTCSessionDescription||$.RTCSessionDescription||$.webkitRTCSessionDescription||$.mozRTCSessionDescription,s=j.RTCIceCandidate||$.RTCIceCandidate||$.webkitRTCIceCandidate||$.mozRTCIceCandidate;if(!n||!f||!s)return;j.RTCPeerConnection=n,j.RTCSessionDescription=f,j.RTCIceCandidate=s,j.rtc=j.rtc||{iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"stun:stun.sipgate.net:3478"}]},j.rtc.dataChannel=j.rtc.dataChannel||{ordered:!1,maxRetransmits:2},j.rtc.sdp=j.rtc.sdp||{mandatory:{OfferToReceiveAudio:!1,OfferToReceiveVideo:!1}},j.rtc.max=j.rtc.max||55,j.rtc.room=j.rtc.room||R.window&&(location.hash.slice(1)||location.pathname.slice(1)),j.announce=function(u){j.rtc.start=+new Date,v.$.get("/RTC/"+j.rtc.room+"<?99").get("+").put(j.pid,function(r){!r.ok||!r.ok.rtc||c(r)},{acks:j.rtc.max}).on(function(r,i,h){r===j.pid||j.rtc.start>h.put[">"]||c({"#":""+h["#"],ok:{rtc:{id:r}}})})};var w=j.mesh=j.mesh||R.Mesh(v);v.on("create",function(u){this.to.next(u),setTimeout(j.announce,1)});function c(u){if(this&&this.off&&this.off(),!!u.ok){var r=u.ok.rtc,i,h;if(!(!r||!r.id||r.id===j.pid)){if(h=r.answer)return!(i=j.peers[r.id]||c[r.id])||i.remoteSet?void 0:(h.sdp=h.sdp.replace(/\\r\\n/g,`\r
`),i.setRemoteDescription(i.remoteSet=new j.RTCSessionDescription(h)));if(h=r.candidate)return i=j.peers[r.id]||c[r.id]||c({ok:{rtc:{id:r.id}}}),i.addIceCandidate(new j.RTCIceCandidate(h));if(!c[r.id]){(i=new j.RTCPeerConnection(j.rtc)).id=r.id;var k=i.wire=i.createDataChannel("dc",j.rtc.dataChannel);if(c[r.id]=i,k.to=setTimeout(function(){delete c[r.id]},1e3*60),k.onclose=function(){w.bye(i)},k.onerror=function(t){},k.onopen=function(t){delete c[r.id],w.hi(i)},k.onmessage=function(t){t&&w.hear(t.data||t,i)},i.onicecandidate=function(t){t.candidate&&v.on("out",{"@":u["#"],ok:{rtc:{candidate:t.candidate,id:j.pid}}})},i.ondatachannel=function(t){var p=t.channel;p.onmessage=k.onmessage,p.onopen=k.onopen,p.onclose=k.onclose},h=r.offer){r.offer.sdp=r.offer.sdp.replace(/\\r\\n/g,`\r
`),i.setRemoteDescription(new j.RTCSessionDescription(h)),i.createAnswer(function(t){i.setLocalDescription(t),v.on("out",{"@":u["#"],ok:{rtc:{answer:t,id:j.pid}}})},function(){},j.rtc.sdp);return}return i.createOffer(function(t){i.setLocalDescription(t),v.on("out",{"@":u["#"],"#":v.ask(c),ok:{rtc:{offer:t,id:j.pid}}})},function(){},j.rtc.sdp),i}}}}})}()),ot}jt();const ct=["http://localhost:8765/gun","https://chilly-charmain-can-turgay-2bdb3640.koyeb.app/gun"],F=_t({peers:ct,radisk:!0});window.gun=F;window.restoreGunConnections=function(){const v=F._.opt.peers||{};ct.forEach(j=>{v[j]||F.opt({peers:[j]})}),console.info("[GUN] Reconnection attempt triggered.")};window.blockGunConnections=function(){const v=F._.opt.peers||{};Object.values(v).forEach(j=>{if(j&&j.wire&&j.wire.close)try{j.wire.close()}catch($){console.warn("[GUN] Error while closing peer wire",$)}}),F._.opt.peers={},console.info("[GUN] All peer connections have been blocked.")};window.addEventListener("online",()=>{window.restoreGunConnections()});setTimeout(()=>{Object.values(F._.opt.peers).some(v=>v.wire&&v.wire.readyState===1)||(F.opt({peers:["https://gun-manhattan.herokuapp.com/gun"]}),console.info("[GUN] Added Manhattan fallback peer"))},3e3);export{Dt as Q,Ot as S,kt as a,at as b,F as g,gt as u};
